<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <title>æœ€å°äºŒä¹—æ³•ã§å§‹ã‚ã‚‹ã‚«ãƒ¼ãƒ–ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚° - roki.log</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" />
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../../../../../theme/style.css" rel="stylesheet" />
    <link rel="shortcut icon" href="../../../../../favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/solid.css" integrity="sha384-TbilV5Lbhlwdyc4RuIV/JhD8NR+BfMrvz4BL5QFa2we1hQu6wvREr3v6XSRfCTRp" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/brands.css" integrity="sha384-7xAnn7Zm3QC1jFjVc1A6v/toepoG3JXboQYzbM0jrPzou9OFXm/fY6Z/XiIebl/k" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/fontawesome.css" integrity="sha384-ozJwkrqb90Oa3ZNb+yKFW2lToAWYdTiF1vt8JiH5ptTGHTGcN7qdoR1F95e0kYyG" crossorigin="anonymous">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="../../../../../theme/js/css_browser_selector.js" type="text/javascript"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="roki" />
        <link href="../../../../../theme/tipuesearch/tipuesearch.css" rel="stylesheet">
        <link href="../../../../../theme/typogrify.css" rel="stylesheet">
    <link href="https://falgon.github.io/roki.log/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="roki.log Full Atom Feed" />
    <link href="https://falgon.github.io/roki.log/feeds/math.rss.xml" type="application/atom+xml" rel="alternate" title="roki.log Categories Atom Feed" />

  </head>
  <body id="index" class="archive" style="font-family: 'æ¸¸æ˜æœ', 'Yu Mincho' , 'æ¸¸æ˜æœä½“' , 'YuMincho' , 'ãƒ’ãƒ©ã‚®ãƒæ˜æœ Pro W3' , 'Hiragino Mincho Pro' , 'HiraMinProN-W3', 'HGSæ˜æœE' , 'ï¼­ï¼³ ï¼°æ˜æœ' , 'MS PMincho', serif;">
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

<div class="modal fade" id="myModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">ğŸ‘‹New blog information / ãƒ–ãƒ­ã‚°ç§»è»¢ã®ãŠçŸ¥ã‚‰ã›</h4>
      </div>
      <div class="modal-body">
      This blog has been moved to <a href="https://roki.dev/roki.log">new one (roki.dev/roki.log)</a> for 
      serving you better view. This blog is no longer updated.
      Thank you for migrating and re-registering your bookmarks.
      <hr >
      ã“ã®ãƒ–ãƒ­ã‚°ã¯, 
      <a href="https://roki.dev/roki.log">æ–°ãƒ–ãƒ­ã‚° (roki.dev/roki.log)</a> 
      ã«ç§»è»¢ã—ã¾ã—ãŸã€‚ã“ã®ãƒšãƒ¼ã‚¸ã®ä»Šå¾Œã®æ›´æ–°ã¯ã‚ã‚Šã¾ã›ã‚“ãŒ,
      ç§»è¡Œç”¨, è¨˜éŒ²ç”¨ã«æ®‹ã•ã‚Œã¦ã„ã¾ã™ã€‚
      ã‚‚ã—å®œã—ã‘ã‚Œã°, ç§»è¡Œ, ã¾ãŸã¯ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã®å†ç™»éŒ²ã‚’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">é–‰ã˜ã‚‹</button>
       </div>
    </div>
  </div>
</div>

    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../../..">roki.log</a>
        </div>
        <div class="collapse navbar-collapse navbar-right">
          <ul class="nav navbar-nav">
            <li>
                    <a href="../../../../../pages/about"><i class="fas fa-info-circle" style="margin-right: 4px;"></i>About</a>
            </li>
            <li>
            </li>
            
            <li><a href="../../../../../tags.html"><i class="fas fa-tags" style="margin-right: 4px;"></i>Tags</a></li>
            <li><span>
                <form class="navbar-search" action="https://falgon.github.io/roki.log/search.html">
                    <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
            </li>
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
    </nav>
    <div class="container">
    <section id="content" class="article content">
      <header>
        <h2 class="entry-title">
          æœ€å°äºŒä¹—æ³•ã§å§‹ã‚ã‚‹ã‚«ãƒ¼ãƒ–ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
        </h2>
        
        <div class="text-muted">æœ¨ 03 1æœˆ 2019</div>
      </header>
<!-- .entry-content -->
      <div class="entry-content">
        <h3>è¦æ—¨</h3>
<p>æœ¬ã‚¨ãƒ³ãƒˆãƒªãƒ¼(<span class="caps">WIP</span>)ã¯ã‚«ãƒ¼ãƒ–ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°å…¨èˆ¬ã«é–¢ã—ã¦è¨˜è¿°ã—ãŸã‚‚ã®ã§ã‚ã‚Š,
ãã‚Œãã‚Œã®åŸç†, æ€§è³ªã«ã¤ã„ã¦å­¦ã‚“ã éš›ã®ãƒ¡ãƒ¢ã¨ã—ã¦, ã‚ˆã‚Šå˜ç´”ãªã‚‚ã®ã‹ã‚‰åºƒãæµ…ãæŒ™ã’ã¦ã„ã¾ã™.
æ¥µåŠ›ãªã„ã‚ˆã†ã«ã¯ã—ã¦ã„ã¾ã™ãŒ, æœ¬å†…å®¹ã¯ç‹¬å­¦ã§å¾—ãŸçŸ¥è¦‹ã‚ˆã‚Šæ›¸ã„ã¦ãŠã‚Šã¾ã™ã®ã§,
ä¸€éƒ¨æ­£ç¢ºã•ãŒæ¬ ã‘ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã¯å¦ã‚ã¾ã›ã‚“.
ä½•ã‹ã‚ã‚Šã¾ã—ãŸã‚‰, ã‚³ãƒ¡ãƒ³ãƒˆç­‰ã§æŒ‡æ‘˜ã—ã¦ã„ãŸã ã‘ã‚‹ã¨ã‚ã‚ŠãŒãŸã„ã§ã™.
ã¾ãŸ,&nbsp;æœ¬ã‚¨ãƒ³ãƒˆãƒªå†…ã«ãŠã‘ã‚‹è¿‘ä¼¼ãŠã‚ˆã³ãƒ—ãƒ­ãƒƒãƒˆç­‰ã«é–¢ã™ã‚‹å®Ÿè£…ã¯æ¬¡ã®ãƒªãƒã‚¸ãƒˆãƒª</p>
<p style="text-align: center;">
<i class="fab fa-github" style="font-size: large; margin-right: 5px;"></i>
<a href="https://github.com/falgon/PlayLinearAlgebra">falgon/PlayLinearAlgebra - My playground about linear albebra: <span class="caps">LU</span> decomposition, pseudo inverse, least squared method,&nbsp;etc&#8230;</a>
</p>

<p>ã«ã¾ã¨ã¾ã£ã¦ã„ã¾ã™.</p>
<h3>ç·šå½¢å›å¸°</h3>
<p>ã¾ãšã¯, å›å¸°è§£æã®ã†ã¡æœ€ã‚‚åŸºæœ¬çš„ãªæ‰‹æ³•ã§ã‚ã‚‹æœ€å°äºŒä¹—æ³•ã«ã¤ã„ã¦.
æ¬¡ã®ã‚ˆã†ãªæ•£å¸ƒå›³<sup id="fnref-1"><a class="footnote-ref" href="#fn-1">1</a></sup>ã‚’è€ƒãˆã‚‹.</p>
<p style="text-align:center">
<img src="../../../../../images/2018/October/20/data.png" alt="dataset figure" width="600px"></p>

<p>ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯, <a href="https://en.wikipedia.org/wiki/Mile_run">ãƒã‚¤ãƒ«ãƒ©ãƒ³</a>ã¨ã„ã†ä¸­è·é›¢ãƒãƒ©ã‚½ãƒ³ã«ãŠã‘ã‚‹ç”·å­ä¸–ç•Œè¨˜éŒ²ã®é·ç§»ã‚’è¡¨ã—ã¦ãŠã‚Š,
æ¨ªè»¸ãŒä¸–ç•Œè¨˜éŒ²ã‚’æ›´æ–°ã—ãŸå¹´, ç¸¦è»¸ãŒãã®è¨˜éŒ²ã®ç§’æ•°ã¨ãªã£ã¦ã„ã‚‹.
ã“ã®æ•£å¸ƒå›³ã¯è² ã®ç›¸é–¢é–¢ä¿‚ãŒã‚ã‚‹ã¨ã„ãˆã‚‹.
ã¾ã‚, è¨˜éŒ²ã®æ›´æ–°ã¨ã„ã†ã®ã¯, ã‚´ãƒ¼ãƒ«ã™ã‚‹ã¾ã§ã®ã‚¿ã‚¤ãƒ ãŒç¸®ã‚“ã ã¨ã„ã†ã“ã¨ã‚’ã„ã†ã®ã§,&nbsp;ã“ã‚Œã¯å½“ãŸã‚Šå‰ã®ç›¸é–¢é–¢ä¿‚ã§ã‚ã‚‹.</p>
<p>ã“ã®ã‚ˆã†ãªç›´ç·šçš„ãªé–¢ä¿‚ãŒã‚ã‚‹ã‚ˆã†ã«ã¿ãˆã‚‹ã‚ˆã†ãªæ•£å¸ƒã«ã¤ã„ã¦,
ãã‚Œãªã‚Šã«ãã‚Œã‚‰ã®ç‚¹ã«ç›¸å¿œã—ã„ã‚ˆã†ãªç›´ç·š,
ã¤ã¾ã‚Šå„ç‚¹ã‹ã‚‰ã®è·é›¢ãŒæœ€ã‚‚å°ã•ããªã‚‹ã‚ˆã†ãªç›´ç·šã‚’å¼•ããŸã„ã¨ã—ã‚ˆã†.&nbsp;ã“ã‚ŒãŒæœ¬ã‚¨ãƒ³ãƒˆãƒªã«ãŠã‘ã‚‹ä¸»é¡Œã§ã‚ã‚‹.</p>
<h4>ç·šå½¢æœ€å°äºŒä¹—æ³•</h4>
<p>æœ€å°äºŒä¹—æ³•ã¯, ä¸Šè¨˜ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã®çµ„ <span class="math">\(\left(x_i,y_i\right)\)</span> ãŒ \(n\) çµ„ä¸ãˆã‚‰ã‚ŒãŸã¨ã(\(x_i\) ã®å…¨ã¦ãŒç­‰ã—ã„å ´åˆã‚’é™¤ã„ã¦)ã«, 
ãã‚Œã‚‰ã®ç‚¹ã«ç›¸å¿œã—ã„é–¢æ•° \[y_i=a_i+a_ix^1_1+\cdots+a_ix^n_i\label{eq:ffirst}\tag{i}\] ã®ä¿‚æ•°(å‚¾ãã¨åˆ‡ç‰‡)ã‚’æ±ºå®šã™ã‚‹æ–¹æ³•ã§ã‚ã‚‹(å®šç¾©å¼ã¯ \(\eqref{eq:eleventh}\)). 
ãªãŠ, ã“ã®ã¨ãã®ç·šå½¢æ€§ã¨ã¯, ä¿‚æ•° \(a_k\) ã®ç·šå½¢æ€§ã‚’æ„å‘³ã—ã¦ãŠã‚Š, ã™ãªã‚ã¡å¿œç­”å¤‰æ•° \(y\) ã¯ä¿‚æ•° \(a_k\) ã®ç·šå½¢é–¢æ•°ã‚’è¡¨ã—ã¦ã„ã‚‹.
ã¾ãšã¯æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹ã¨ã—ã¦, å›å¸°ãƒ¢ãƒ‡ãƒ«ã‚’ \(y=ax+b\) ã¨ã—ã¦è€ƒãˆã‚‹ã¨, ã“ã‚Œã«å¯¾ã™ã‚‹ç·šå½¢æœ€å°äºŒä¹—æ³•ã¯,&nbsp;ç°¡å˜ã«å°å‡ºã§ãã‚‹:</p>
<p>ã‚ã‚‹ç‚¹ \(\left(x_i, y_i\right)\) ã¨ãƒ¢ãƒ‡ãƒ«ã¨ãªã‚‹ç›´ç·šã®èª¤å·®, 
ã™ãªã‚ã¡åå·®ã¯ \(y_i-\left(ax_i+b\right)\) ã¨ã‹ã‘ã‚‹.
ã“ã®ã¨ã, å„ç‚¹ã‹ã‚‰ã®è·é›¢ãŒæœ€å°ã§ã‚ã£ã¦ã»ã—ã„ã®ã ã‹ã‚‰,
ã¾ãšç·å’Œã‚’ \[\epsilon(a,b):=\displaystyle\sum^{n}_{i=1}\left(y_i-ax_i-b\right)^2\label{eq:first}\tag{1}\]
ã¨ãŠãã“ã¨ã¨ã™ã‚‹. 
ã„ã¾ã“ã“ã§äºŒä¹—ã—ãŸã®ã¯, ãƒ¢ãƒ‡ãƒ«ã¨ãªã‚‹ç›´ç·šã‚ˆã‚Šã‚‚ä¸‹ã«ç‚¹ãŒã‚ã£ãŸå ´åˆ, ç¬¦å·ãŒè² ã¨ãªã‚Š,
ã“ã‚ŒãŒèª¤å·®ã‚’ç›¸æ®ºã—ã¦ã—ã¾ã£ãŸã‚Š, å€¤ã‚’è² ã«ã—ã¦ã—ã¾ã†ã‹ã‚‰ã§ã‚ã‚‹.
çµ¶å¯¾å€¤ã‚’ç”¨ã„ãªã„ã®ã¯,&nbsp;å¾Œã®å¾®åˆ†è¨ˆç®—ã‚’å¯èƒ½ã«ã™ã‚‹ãŸã‚ã§ã‚ã‚‹.</p>
<p>ã•ã¦, ã„ã¾ \(\eqref{eq:first}\) ã®æœ€å°å€¤ã‚’æ±‚ã‚ãŸã„ã‚ã‘ã ãŒ, 
ç°¡å˜ã®ãŸã‚ã«ã“ã“ã§ã¾ãš \(b\) ã‚’å›ºå®šã—ãŸã¨è€ƒãˆã‚‹. 
ã™ã‚‹ã¨, \(\eqref{eq:first}\) ã¯å˜ãªã‚‹ \(a\) ã®äºŒæ¬¡é–¢æ•°ã¨æ‰ãˆã‚‹ã“ã¨ãŒã§ãã‚‹.
ãã®ä¿‚æ•° \(\displaystyle\sum^{n}_{i=1}x_i^2\) ã¯æ­£ã§ã‚ã‚‹ã®ã§, 
ã“ã®äºŒæ¬¡é–¢æ•°ã¯, ä¸‹ã«å‡¸ã®æ”¾ç‰©ç·šã‚’æãã“ã¨ãŒã‚ã‹ã‚‹.
ã‚ˆã£ã¦ã“ã®äºŒæ¬¡é–¢æ•°ã®æœ€å°å€¤ã¯, æ¥ç·šã®å‚¾ãã‚’ \(0\) ã¨ã—ãŸå€¤ã‚’ã¨ã‚‹ã“ã¨ãŒã„ãˆã‚‹ã®ã§,&nbsp;ãã‚Œã‚’</p>
<p>\[\frac{\partial\epsilon(a,b)}{\partial&nbsp;a}=0\]</p>
<p>ã¨ã‹ã‘ã‚‹. åŒæ§˜ã«, \(a\) ã‚’å›ºå®šã—ãŸã¨è€ƒãˆã‚Œã°, ä¿‚æ•°ã¯ \(n\) ã§ã“ã‚Œã¯æ­£ã§ã‚ã‚‹ã‹ã‚‰,
ã“ã‚Œã‚‚ä¸‹ã«å‡¸ã®æ”¾ç‰©ç·šã‚’æãã“ã¨ãŒã‚ã‹ã‚‹.&nbsp;ã¤ã¾ã‚Šã“ã®å ´åˆã®æœ€å°å€¤ã‚‚,</p>
<p>\[\frac{\partial\epsilon(a,b)}{\partial&nbsp;b}=0\]</p>
<p>ã¨ã‹ã‘ã‚‹. ã„ã¾æ±‚ã‚ãŸã‹ã£ãŸã®ã¯ã“ã®ã©ã¡ã‚‰ã‚’ã‚‚æº€ãŸã™ \(a,b\) ã§ã‚ã‚‹ã®ã§,
ã“ã‚Œã‚‰ã®é€£ç«‹æ–¹ç¨‹å¼ã‚’è§£ã‘ã°è‰¯ã„ã“ã¨ã¨ãªã‚‹. å¾“ã£ã¦ \(\eqref{eq:first}\)&nbsp;ã‚ˆã‚Š</p>
<div class="math">\begin{eqnarray}
&amp;&amp;\begin{cases}
&amp;\displaystyle\frac{\partial\epsilon(a,b)}{\partial a}&amp;=&amp;\displaystyle\sum_{i=1}^{n}2\left(y_i-(ax_i+b)\right)\cdot(-x_i)&amp;=&amp;0 \\\
&amp;\displaystyle\frac{\partial\epsilon(a,b)}{\partial b}&amp;=&amp;\displaystyle\sum_{i=1}^{n}2\left(y_i-(ax_i+b)\right)&amp;=&amp;0
\end{cases}
\end{eqnarray}</div>
<p>ã“ã®ã‚ˆã†ãª, ç·šå½¢æ–¹ç¨‹å¼ã«ãŠã‘ã‚‹ã™ã¹ã¦ã®å®šæ•°é …ãŒ <span class="math">\(0\)</span> ã§ã‚ã‚‹ã‚‚ã®ã‚’åŒæ¬¡ç·šå½¢ç³»(è‹±:homogeneous linear system)ã¨ã„ã†. ã“ã®ä¸¡è¾ºã‚’ \(2\)&nbsp;ã§å‰²ã£ã¦,</p>
<div class="math">\begin{eqnarray}
&amp;\leftrightarrow
&amp;\begin{cases}
&amp;\displaystyle\sum_{i=1}^{n}\left(y_i-(ax_i+b)\right)\cdot x_i&amp;=&amp;0 \\\
&amp;\displaystyle\sum_{i=1}^{n}\left(y_i-(ax_i+b)\right)&amp;=&amp;0
\end{cases} \\\
&amp;\leftrightarrow
&amp;\begin{cases}
&amp;\displaystyle a\sum_{i=1}^{n}x^2_i&amp;+&amp;\displaystyle b\sum_{i=1}^{n}x_i&amp;=&amp;\displaystyle\sum_{i=1}^{n}x_i y_i \\\
&amp;\displaystyle a\sum_{i=1}^{n}x_i&amp;+&amp;bn&amp;=&amp;\displaystyle\sum_{i=1}^{n}y_i 
\end{cases}
\label{eq:second}\tag{2}
\end{eqnarray}</div>
<p>ä¸¡è¾ºã‚’ \(n\)&nbsp;ã§å‰²ã£ã¦,</p>
<div class="math">\begin{eqnarray}
&amp;\leftrightarrow
&amp;\begin{cases}
&amp;\displaystyle a\frac{\sum_{i=1}^{n}x^2_i}{n}&amp;+&amp;\displaystyle b\frac{\sum_{i=1}^{n}x_i}{n}&amp;=&amp;\displaystyle\frac{\sum_{i=1}^{n}x_i y_i}{n} \\\
&amp;\displaystyle a\frac{\sum_{i=1}^n x_i}{n}&amp;+&amp;b&amp;=&amp;\frac{\sum_{i=1}^ny_i}{n}
\end{cases}
\end{eqnarray}</div>
<p>ã“ã“ã§, \(\frac{\sum_{i=1}^n x_i}{n}\) ã¯ \(x\) ã®ç·å’Œã‚’ãã®å€‹æ•°ã§å‰²ã£ã¦ã„ã‚‹ã®ã§
\(x\) ã®å¹³å‡,
\(\frac{\sum_{i=1}^ny_i}{n}\) ã¯ \(y\) ã®ç·å’Œã‚’ãã®å€‹æ•°ã§å‰²ã£ã¦ã„ã‚‹ã®ã§ 
\(y\) ã®å¹³å‡ã§ã‚ã‚‹ã‹ã‚‰,
\(\overline{x}=\frac{\sum_{i=1}^{n}x_i}{n}, \overline{y}=\frac{\sum_{i=1}^ny_i}{n},
\overline{x^2}=\frac{\sum_{i=1}^{n}x_i^2}{n}, 
\overline{xy}=\frac{\sum_{i=1}^{n}x_i y_i}{n}\) ã¨å¹³å‡ã®è¨˜å·ã‚’ç”¨ã„ã¦æ›¸ãã“ã¨ãŒã§ãã‚‹.
ã‚ˆã£ã¦, \(b=-a\overline{x}+\overline{y}\) ã‚’ä»£å…¥ã™ã‚Œã° \(a\) ã‚‚æ±‚ã¾ã‚‹ã‚ã‘ã ãŒ,&nbsp;ä¸€æ—¦ã“ã‚Œã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹ã¨,</p>
<div class="math">\begin{eqnarray}
\left(\begin{array}{cc}
\overline{x^2} &amp; \overline{x} \\\ \overline{x} &amp; 1
\end{array}\right)
\left(\begin{array}{c}
a \\\ b
\end{array}\right)
&amp;=&amp;
\left(\begin{array}{c}
\overline{xy} \\\
\overline{y}
\end{array}\right)
\end{eqnarray}</div>
<p>å·¦è¾ºã®è¡Œåˆ—ã®è¡Œåˆ—å¼ </p>
<div class="math">\begin{eqnarray}
{\rm det}\left(\begin{array}{cc}
\overline{x^2} &amp; \overline{x} \\\ \overline{x} &amp; 1
\end{array}\right)
\end{eqnarray}</div>
<p>ã¯, \(x_i\) ãŒã™ã¹ã¦ç­‰ã—ããªã„é™ã‚Š \(0\) ã¨ã¯ãªã‚‰ãªã„. 
ã„ã¾ã¯ãã®ã‚ˆã†ãªå ´åˆã‚’é™¤ã„ã¦ã„ã‚‹ã‹ã‚‰,&nbsp;åŒè¡Œåˆ—ã¯æ­£å‰‡ã§</p>
<div class="math">\begin{eqnarray}
\left(\begin{array}{c}
a \\\ b
\end{array}\right)
&amp;=&amp;\left(\begin{array}{cc}
\overline{x^2} &amp; \overline{x} \\\ \overline{x} &amp; 1
\end{array}\right)^{-1}
\left(\begin{array}{c}
\overline{xy} \\\
\overline{y}
\end{array}\right) 
\end{eqnarray}</div>
<p>ã‚ˆã‚Š \(\left(a\ b\right)^T\)&nbsp;ã¯</p>
<div class="math">\begin{eqnarray}
&amp;=&amp;\left(\begin{array}{c}
\frac{\overline{xy}-\overline{x}\cdot\overline{y}}{\overline{x^2}-\overline{x}^2} \\\
\frac{\overline{x^2}\cdot\overline{y}-\overline{xy}\cdot\overline{x}}{\overline{x^2}-\overline{x}^2}
\end{array}\right)\label{eq:third}\tag{3}
\end{eqnarray}</div>
<p>ã¨æ±‚ã¾ã‚‹.  ã“ã“ã§, \(\overline{xy}-\overline{x}\cdot\overline{y}\) ã¯å…±åˆ†æ•£,
\(\overline{x^2}-\overline{x}^2\) ã¯åˆ†æ•£ã®å½¢ã«ãªã£ã¦ã„ã‚‹ã®ã§, \(a\) ã¯ \(\frac{\mathrm{Cov}(x,y)}{\sigma_x^2}\) ã¨ã¾ã¨ã‚ã‚‹ã“ã¨ãŒã§ã, ã‚ˆãã¿ã‚‹æœ€å°äºŒä¹—æ³•ã®å®šç¾©å¼ã®å½¢ã¨ãªã£ãŸ.
å®Ÿéš›ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã‚‹ã¨ãã¯, å¹³å‡ãªã©ã¯ã©ã†ã§ã‚‚ã‚ˆãã¦,
å˜ã« \(\eqref{eq:third}\) ã®å„é …ã« \(n\) ã‚’ä¹—ã˜ãŸå½¢ã§è¨ˆç®—ã™ã‚Œã°ã‚ˆã„.&nbsp;ã¤ã¾ã‚Š,</p>
<div class="math">\begin{eqnarray}
\eqref{eq:second}&amp;\leftrightarrow&amp;
\left(\begin{array}{cc}
\displaystyle \sum_{i=1}^{n}x^2_i &amp;\displaystyle \sum_{i=1}^{n}x_i \\\
\displaystyle \sum_{i=1}^{n}x_i &amp;n
\end{array}\right)
\left(\begin{array}{c}
a \\\ b
\end{array}\right)&amp;=&amp;
\left(\begin{array}{c}
\displaystyle\sum_{i=1}^{n}x_i y_i \\\ \displaystyle\sum_{i=1}^{n}y_i 
\end{array}\right)
\\\ 
&amp;\leftrightarrow&amp;
\left(\begin{array}{c}
a \\\ b
\end{array}\right)&amp;=&amp;
\left(\begin{array}{cc}
\displaystyle \sum_{i=1}^{n}x^2_i &amp;\displaystyle \sum_{i=1}^{n}x_i \\\
\displaystyle \sum_{i=1}^{n}x_i &amp;n
\end{array}\right)^{-1}
\left(\begin{array}{c}
\displaystyle\sum_{i=1}^{n}x_i y_i \\\ \displaystyle\sum_{i=1}^{n}y_i 
\end{array}\right) \\\
&amp;&amp;&amp;=&amp;\left(\begin{array}{c}
\frac{\left(\sum^n_{i=1}x_iy_i\right) n-\left(\sum^n_{i=1}x_i\right)\left(\sum^n_{i=1}y_i\right)}{\left(\sum^n_{i=1}x^2_i\right) n-\left(\sum^n_{i=1}x_i\right)^2} \\\
\frac{\left(\sum^n_{i=1}x^2_i\right)\left(\sum^n_{i=1}y_i\right)-\left(\sum^n_{i=1}x_iy_i\right)\left(\sum^n_{i=1}x_i\right)}{\left(\sum^n_{i=1}x^2_i\right) n-\left(\sum^n_{i=1}x_i\right)^2}
\end{array}\right)
\end{eqnarray}</div>
<p>ã§ã‚ã‚‹. ã“ã‚Œã‚’ç”¨ã„ã¦,&nbsp;æ¬¡ã®ã‚ˆã†ã«è¿‘ä¼¼ã§ãã‚‹.</p>
<p style="text-align:center">
<img src="../../../../../images/2018/October/20/lenarEquations.png" alt="lenear equations" width="600px">
</p>

<p>ã¨ã„ã†ã®ãŒ, æœ€ã‚‚ç´ æœ´ãªæœ€å°äºŒä¹—æ³•ã®ä¾‹ã§ã‚ã‚‹<sup id="fnref-2"><a class="footnote-ref" href="#fn-2">2</a></sup>. 
ã‚ˆã‚Šä¸€èˆ¬ã«, \(y\) ãŒ \(m\) æ¬¡ã®å¤šé …å¼ \(\displaystyle f(x)=b+\sum_{j=1}^{m}a_j x^{j}\) 
ã¨ã—ã¦è¡¨ã•ã‚Œã‚‹ã‚ˆã†ãªå ´åˆã«ã¤ã„ã¦ã‚‚, åŒæ§˜ã«ã—ã¦ã„ã†ã“ã¨ãŒã§ãã‚‹.
ã“ã®å ´åˆ,&nbsp;åå·®ã®äºŒä¹—å’Œã¯,</p>
<p>\[\displaystyle\epsilon=\sum^{n}_{i=1}\left(y_i-b-\sum_{j=1}^{m}a_j&nbsp;x^{j}\right)^2\label{eq:fourth}\tag{4}\]</p>
<p>å…ˆã¨åŒæ§˜, å„å¤‰æ•°ã”ã¨ã®åå¾®åˆ†ãŒ \(0\)&nbsp;ã¨ãªã‚‹é€£ç«‹æ–¹ç¨‹å¼ã‚’è§£ã‘ã°è‰¯ã„ã‹ã‚‰,</p>
<div class="math">\begin{eqnarray}
\begin{cases}
&amp;\displaystyle\frac{\partial\epsilon}{\partial b}&amp;=&amp;\displaystyle-\sum_{i=1}^{n}2\left(y_i-b-\sum_{j=1}^{m}a_j x^{j}\right)&amp;=&amp;0 \\\
&amp;\displaystyle\frac{\partial\epsilon}{\partial a_1}&amp;=&amp;\displaystyle-\sum_{i=1}^{n}2x_i\left(y_i-b-\sum_{j=1}^{m}a_j x^{j}\right)&amp;=&amp;0 \\\
&amp;&amp;&amp;\vdots&amp; \\\
&amp;\displaystyle\frac{\partial\epsilon}{\partial a_m}&amp;=&amp;\displaystyle-\sum_{i=1}^{n}2x^m_i\left(y_i-b-\sum_{j=1}^{m}a_j x^{j}\right)&amp;=&amp;0 
\end{cases}
\end{eqnarray}</div>
<p>å…ˆã®ä¾‹ã«åˆã‚ã›ã¦, ä¸¡è¾ºã‚’ \(2n\) ã§å‰²ã£ãŸè¡Œåˆ—ã¨ã™ã‚‹ã¨,&nbsp;å¹³å‡ã®è¨˜å·ã‚’ç”¨ã„ã¦</p>
<div class="math">\begin{eqnarray}
\left(\begin{array}{cccc}
1 &amp; \overline{x} &amp; \cdots &amp; \overline{x^m} \\\
\overline{x} &amp; \overline{x^2} &amp; \cdots &amp; \overline{x^{m+1}} \\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\\
\overline{x^m} &amp; \overline{x^{m+1}} &amp; \cdots &amp; \overline{x^{2m}}
\end{array}\right)
\left(\begin{array}{c}
b \\\ a_1 \\\ \vdots \\\ a_m
\end{array}\right)=
\left(\begin{array}{c}
\overline{y} \\\
\overline{xy} \\\
\vdots \\\
\overline{x^my}
\end{array}\right)
\end{eqnarray}</div>
<p>ãªã®ã§,</p>
<div class="math">\begin{eqnarray}
\left(\begin{array}{c}
b \\\ a_1 \\\ \vdots \\\ a_m
\end{array}\right)&amp;=&amp;
\left(\begin{array}{cccc}
1 &amp; \overline{x} &amp; \cdots &amp; \overline{x^m} \\\
\overline{x} &amp; \overline{x^2} &amp; \cdots &amp; \overline{x^{m+1}} \\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\\
\overline{x^m} &amp; \overline{x^{m+1}} &amp; \cdots &amp; \overline{x^{2m}}
\end{array}\right)^{-1}
\left(\begin{array}{c}
\overline{y} \\\
\overline{xy} \\\
\vdots \\\
\overline{x^my}
\end{array}\right) \\\
&amp;=&amp;\left(\begin{array}{cccc}
n &amp; \displaystyle\sum^{n}_{i=1}x_i &amp; \cdots &amp; \displaystyle\sum^{n}_{i=1}x^m_i \\\
\displaystyle\sum^{n}_{i=1}x_i &amp; \displaystyle\sum^{n}_{i=1}x_i^2 &amp; \cdots &amp; \displaystyle\sum^{n}_{i=1}x_i^{m+1} \\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\\
\displaystyle\sum^{n}_{i=1}x_i^m &amp; \displaystyle\sum^{n}_{i=1}x_i^{m+1} &amp; \cdots &amp; \displaystyle\sum^{n}_{i=1}x_i^{2m}
\end{array}\right)^{-1}
\left(\begin{array}{c}
\displaystyle\sum^n_{i=1}y_i \\\ \displaystyle\sum^n_{i=1}x_iy_i \\\ \vdots \\\ \displaystyle\sum^n_{i=1}x_i^my_i
\end{array}\right)
\end{eqnarray}</div>
<p>ã§æ±‚ã¾ã‚‹. 
ã“ã®æ­£ç¢ºãªè§£ã‚’æ©Ÿæ¢°çš„ã«æ±‚ã‚ã‚‹å ´åˆã«ã¯,
ã“ã®é€†è¡Œåˆ—ã‚’æ±‚ã‚ãªãã¨ã‚‚,&nbsp;ã‚¬ã‚¦ã‚¹ã®æ¶ˆå»æ³•ãªã©ã‚’åŸºæœ¬ã¨ã—ãŸè§£æ³•(ç›´æ¥è§£æ³•)ã§è§£ã‘ã‚‹.</p>
<p>å…ˆã®ãƒ‡ãƒ¼ã‚¿ã¯ç›´ç·šçš„ã§ã‚ã£ãŸã®ã§, ä»Šåº¦ã¯æ›²ç·šãŒå¼•ã‘ãã†ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ã—ã¦, \(x_i=i-1, y_i=\sin(x_i)+\epsilon, i=1,2,\cdots,11\) ã«å¯¾ã—, ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’è©¦è¡Œã—ã¦ã¿ã‚‹äº‹ã¨ã™ã‚‹.
ã“ã“ã§ \(\epsilon\) ã¯ \(\mathrm{N}(0, 0.2)\) ã®æ­£è¦åˆ†å¸ƒã«å¾“ã†ç¢ºç‡å¤‰æ•°ã§ã‚ã‚‹.
æ¬¡ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯, æ¬¡æ•° \(1\leq m\leq 9\) ã«å¿œã˜ãŸè¿‘ä¼¼ã®é·ç§»ã‚’è¦³å¯Ÿã§ãã‚‹(<span class="caps">LU</span> åˆ†è§£ã«ã‚ˆã‚‹è¨ˆç®— \(\to\) <a href="https://falgon.github.io/roki.log/posts/2019/%201%E6%9C%88/01/LUDecomposition/">è§£èª¬</a>).</p>
<p style="text-align:center">
<img src="../../../../../images/2018/October/20/out.gif" alt="lenear equations" width="600px">
</p>

<p>ã¨ã“ã‚ã§, å†’é ­ã§ç¤ºã—ãŸé–¢æ•° \(\eqref{eq:ffirst}\) ã®ç·šå½¢å›å¸°ãƒ¢ãƒ‡ãƒ«ã¯,&nbsp;æ¬¡ã®ã‚ˆã†ã«è¡¨ã™ã“ã¨ãŒã§ãã‚‹.</p>
<p>\[y_i=a_0+\sum^m_{j=1}a_jf_j(x_i^1,x_i^2,\cdots,x_i^n)+u_i,\&nbsp;i=1,\cdots,m\label{eq:ssecond}\tag{ii}\]</p>
<p>ã“ã“ã§, \(f_j\) ã¯ç‹¬ç«‹å¤‰æ•° \(x_{i}^k\) ã®ã‚¹ã‚«ãƒ©ãƒ¼é–¢æ•°, \(u_i\) ã¯ \(i\) ç•ªç›®ã®ãƒã‚¤ã‚ºé …(ç¢ºç‡å¤‰æ•°)ã§ã‚ã‚‹.
ç·šå½¢æœ€å°äºŒä¹—æ³•ã¯, å˜ã«ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿å€¤ã«å¯¾ã™ã‚‹åå·®ã®äºŒä¹—å’Œã‚’æœ€å°åŒ–ã™ã‚‹. ã™ãªã‚ã¡, ãƒ‡ãƒ¼ã‚¿ã«é–¢ã‚ã‚‰ãšå…¨ã¦ã®å€¤ãŒåŒã˜ã‚ˆã†ã«æ‰±ã‚ã‚Œã‚‹.
ã“ã‚Œã¯, ã™ã¹ã¦ã®ãƒã‚¤ã‚ºé … \(u_i\) ã®ç¢ºç‡åˆ†å¸ƒãŒåŒä¸€ã§ã‚ã‚‹ã¨ä»®å®šã™ã‚‹ã“ã¨ã¨åŒå€¤ã§ã‚ã‚Š,
å¾“ã£ã¦, ã™ã¹ã¦ã® \(u_i\) ã¯ç„¡ç›¸é–¢ã‹ã¤ <a href="https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#iid">i.i.d</a> ã§
\(\mathrm{N}\left(0,\sigma^2\right)\) (æ¨™æº–æ­£è¦åˆ†å¸ƒ) ã«å¾“ã†ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã‚‹ã¨ã„ãˆã‚‹<sup id="fnref-4"><a class="footnote-ref" href="#fn-4">4</a></sup>.</p>
<h4>ä¸€èˆ¬é€†è¡Œåˆ—</h4>
<p>ã“ã“ã¾ã§ã¯, å›å¸°ç›´ç·šã®è€ƒãˆæ–¹ã«æ²¿ã£ã¦è¿‘ä¼¼æ›²ç·š/ç›´ç·šã‚’å¾—ãŸè¨³ã§ã‚ã‚‹ãŒ, 
ãã‚‚ãã‚‚, \((x_i,y_i)\) ã®çµ„ãŒã‚ã£ã¦ç·šå½¢æ–¹ç¨‹å¼ \(y\) ã® \(x\) 
ã«é–¢ã™ã‚‹é–¢æ•°ã«ãŠã‘ã‚‹&#8221;é©å½“ãª&#8221;ä¿‚æ•°ãŒ&#8221;ç›´æ¥&#8221;æ±‚ã¾ã‚‹ã‚ˆã†ãªè¡Œåˆ—ãŒã‚ã‚Œã°è‰¯ã„ã®ã§ã¯ãªã„ã ã‚ã†ã‹. 
ã¤ã¾ã‚Š \(m\) ã‚’æ–¹ç¨‹å¼ã®å€‹æ•°, \(n&#8217;=n+1\) ã‚’æœªçŸ¥æ•°ã®å€‹æ•°ã¨ã—, \(X\boldsymbol{a}=\boldsymbol{y}\ \ {\rm where}\ X\in\mathbb{R}^{m\times n&#8217;}, \boldsymbol{a}\in\mathbb{R}^{n&#8217;\times 1}, \boldsymbol{y}\in\mathbb{R}^{m\times 1}\)<sup id="fnref-5"><a class="footnote-ref" href="#fn-5">5</a></sup> ã¨ã—ãŸã¨ã</p>
<div class="math">\begin{eqnarray}
\left(\begin{array}{c}
y_1 \\\
y_2 \\\
\vdots \\\
y_m
\end{array}\right)=
\left(\begin{array}{cccc}
x_1^0 &amp; x_1^1 &amp; \cdots &amp; x_1^n \\\
x_2^0 &amp; x_2^1 &amp; \cdots &amp; x_2^n \\\
\vdots  &amp; \vdots &amp; \ddots &amp; \vdots \\\
x_m^0 &amp; x_m^1 &amp;\cdots &amp; x_m^n
\end{array}\right)
\left(\begin{array}{c}
a_0 \\\
a_1 \\\
\vdots \\\
a_n
\end{array}\right) \\\
\left(\begin{array}{cccc}
x_1^0 &amp; x_1^1 &amp; \cdots &amp; x_1^n \\\
x_2^0 &amp; x_2^1 &amp; \cdots &amp; x_2^n \\\
\vdots  &amp; \vdots &amp; \ddots &amp; \vdots \\\
x_m^0 &amp; x_m^1 &amp;\cdots &amp; x_m^n
\end{array}\right)^{-1}
\left(\begin{array}{c}
y_1 \\\
y_2 \\\
\vdots \\\
y_m
\end{array}\right)
=
\left(\begin{array}{c}
a_0 \\\
a_1 \\\
\vdots \\\
a_n
\end{array}\right)\label{eq:fifth}\tag{5}
\end{eqnarray}</div>
<p>ã‚’è§£ã„ã¦, ãã‚ŒãŒæ±‚ã¾ã‚Œã°è‰¯ã„ã®ã§ã¯ãªã„ã‹, 
ã¨ã„ã†ã“ã¨ã§ã‚ã‚‹(\(n+1\) ã¨ \(m\) ã¯å¿…ãšã—ã‚‚ç­‰ã—ããªã„ã“ã¨ã«æ³¨æ„<sup id="fnref-3"><a class="footnote-ref" href="#fn-3">3</a></sup>). ã“ã®ã¨ãã«è€ƒãˆã‚‰ã‚Œã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯,&nbsp;æ¬¡ã®ã¨ãŠã‚Šã§ã‚ã‚‹:</p>
<ol>
<li>\(n&#8217;=m\) ã‹ã¤ãã®ãƒ©ãƒ³ã‚¯ \({\rm rank}(X)\) ãŒ \(n&#8217;=m\)(ãƒ•ãƒ«ãƒ©ãƒ³ã‚¯)ãªã‚‰ã°, \(X\) ã¯æ­£å‰‡ã§ã‚ã‚‹. å¾“ã£ã¦, \(X^{-1}X\boldsymbol{a}=X^{-1}\boldsymbol{y}\)&nbsp;ã¨ã—ã¦è§£ãŒæ±‚ã¾ã‚‹. </li>
<li>\(n&#8217;\lt m\) ã‹ã¤ãã®ãƒ©ãƒ³ã‚¯ãŒ \(n&#8217;\)(åˆ—ãƒ•ãƒ«ãƒ©ãƒ³ã‚¯)ãªã‚‰ã°, ã™ã¹ã¦ã®æ–¹ç¨‹å¼ã‚’æº€ãŸã™ã‚ˆã†ãªè§£ãŒå­˜åœ¨ã—ãªã„ã“ã¨ãŒã„ãˆã‚‹.  ã“ã‚Œã¯, ã™ã¹ã¦ã®æ–¹ç¨‹å¼ã‚’ãã‚Œãã‚Œç›´ç·šã¨æ‰ãˆãŸã¨ãã«, ãã‚Œã‚‰ã™ã¹ã¦ã®äº¤ç‚¹ã¨ãªã‚‹ä¸€ç‚¹ãŒå­˜åœ¨ã—ãªã„ã“ã¨ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹ã¨ã‚ã‹ã‚Šã‚„ã™ã„. è¦ã™ã‚‹ã«, \(\boldsymbol{a}\) ã«å¯¾ã™ã‚‹ \(X\) ã¨ \(\boldsymbol{y}\) ã®åˆ¶ç´„ãŒç›¸äº’çš„ã«æˆç«‹ã—ãªã„ã®ã§ã‚ã‚‹. ã“ã“ã§ \({\rm rank}(X)\lt n&#8217;\)(ãƒ©ãƒ³ã‚¯è½ã¡)ãªã‚‰ã°,&nbsp;æ–¹ç¨‹å¼ã®ã©ã“ã‹ã«é‡è¤‡ãŒã‚ã‚‹. </li>
<li>\(m\lt n&#8217;\) ã‹ã¤ãã®ãƒ©ãƒ³ã‚¯ãŒ \(m\)(è¡Œãƒ•ãƒ«ãƒ©ãƒ³ã‚¯)ãªã‚‰ã°, è§£ãŒä¸€æ„ã¨ãªã‚‰ãªã„ã“ã¨ãŒã„ãˆã‚‹. ã“ã‚Œã‚‚, æ–¹ç¨‹å¼ã‚’ç›´ç·šã«æ‰ãˆã‚‹ã¨, \(\boldsymbol{a}\) ã«å¯¾ã™ã‚‹åˆ¶ç´„ãŒè¶³ã‚Šãªã„ã“ã¨ã§, æ–¹ç¨‹å¼ã§æ§‹æˆã•ã‚Œã‚‹ç›´ç·šä¸Šã®ã™ã¹ã¦ãŒè§£ã¨ãªã‚Šã†ã‚‹ã“ã¨ã‹ã‚‰ç´å¾—ã§ãã‚‹. ã“ã“ã§ \({\rm rank}(X)\lt m\)(ãƒ©ãƒ³ã‚¯è½ã¡)ãªã‚‰ã°,&nbsp;æ–¹ç¨‹å¼ã®ã©ã“ã‹ã«é‡è¤‡ãŒã‚ã‚‹. </li>
</ol>
<p>ã„ã¾ 2 ã¤ã®é‡è¤‡ãŒã‚ã‚‹å ´åˆã‚’è€ƒãˆã‚‹ã“ã¨ãŒã§ããŸãŒ, é‡è¤‡ã‚’é™¤ã‘ã°, ã„ã¾è¿°ã¹ãŸã†ã¡ã®ã©ã‚Œã‹ã«å¸°ç€ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹.
é‡è¤‡ã®å ´åˆã‚’ç›´ç·šã§æ‰ãˆã‚‹ã¨, ãã‚Œãã‚Œã®æ–¹ç¨‹å¼ãŒ \(x, y\) ã®é–¢ä¿‚ã«é–¢ã—ã¦å…¨ãç•°ãªã‚‹è§£ã‚’ç¤ºã—ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ãªã®ã§,&nbsp;ãã‚Œãã‚Œã®ç›´ç·šã¯å¹³è¡Œã®é–¢ä¿‚ã«ã‚ã‚‹ã“ã¨ã¨ãªã‚‹.</p>
<p>ã¾ã¨ã‚ã‚‹ã¨, ã¤ã¾ã‚Š \(X\boldsymbol{a}=\boldsymbol{y}\) ã¨ã„ã†ã‚ˆã†ã«è¡¨ã•ã‚Œã‚‹ç·šå½¢æ–¹ç¨‹å¼ã«ã¯, ä»¥ä¸Šã® 3 ã¤ã®ãƒ‘ã‚¿ãƒ¼ãƒ³(é‡è¤‡ã«ã¤ã„ã¦è€ƒãˆã‚Œã° 4 ãƒ‘ã‚¿ãƒ¼ãƒ³)ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹.
ã“ã‚Œã‚‰ã®ã™ã¹ã¦ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾ã—ã¦&#8221;é©å½“ã§ã‚ã‚‹ã‚ˆã†ãª&#8221;è§£ã‚’ä¸ãˆã‚‹é€†è¡Œåˆ—ã‚’è€ƒãˆã‚Œã°, ã©ã®ã‚ˆã†ãªæ–¹ç¨‹å¼ã«ã‚‚&#8221;é©å½“ã§ã‚ã‚‹ã‚ˆã†ãª&#8221;è§£ã‚’ä¸ãˆã‚‹ã“ã¨ãŒã§ãã‚‹.
ã“ã®ã‚ˆã†ã«,&nbsp;æ­£å‰‡ã§ãªã„è¡Œåˆ—ã«å¯¾ã™ã‚‹æ“¬ä¼¼çš„ãªé€†è¡Œåˆ—ã®å®šç¾©ã‚’ä¸€èˆ¬é€†è¡Œåˆ—ã¨ã„ã†.</p>
<div class="panel panel-default">
<div class="panel-heading def"><a name="GeneralizedInverse" class="disabled">ä¸€èˆ¬é€†è¡Œåˆ—</a></div>
  <div class="panel-body" style="overflow:scroll">
  æ¬¡ã®å¼ã‚’æº€ãŸã™è¡Œåˆ—
  &#92;(X^-\in\mathbb{R}^{m\times n&#8217;}&#92;) 
  ã‚’ä¸€èˆ¬é€†è¡Œåˆ—ã¨ã„ã„,
  &#92;(X&#92;) ãŒç‰¹ç•°è¡Œåˆ—ãªã‚‰ã° &#92;(X^-&#92;) ã¯ä¸€æ„ã§ã¯ãªã„ãŒå¸¸ã«å­˜åœ¨ã™ã‚‹. 
  &#92;[X X^-X = X&#92;]
  </div>
</div>

<p><span class="dquo">&#8220;</span>é©å½“ã§ã‚ã‚‹ã‚ˆã†ãª&#8221;è§£ã¯æ§˜ã€…ã«è€ƒãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã«, ä¸€èˆ¬é€†è¡Œåˆ—ã®å®šç¾©ã‚‚æ§˜ã€…ã§ã‚ã‚‹.
ä»¥ä¸‹ã‚„ã‚„å¤©ä¸‹ã‚Šçš„ã§ã¯ã‚ã‚‹ãŒä¾¿å®œä¸Šã®ç†ç”±ã‚ˆã‚Šç¤ºã—ã¦ã—ã¾ã†ã¨,
ã„ãã‚‰ã‹ã®ä¸€èˆ¬é€†è¡Œåˆ—ã¯æ¬¡ã§å®šã‚ã‚‹ãƒ ãƒ¼ã‚¢ãƒ»ãƒ™ãƒ³ãƒ­ãƒ¼ã‚ºä¸€èˆ¬é€†è¡Œåˆ—(ä»¥ä¸‹ <span class="caps">MP</span> é€†è¡Œåˆ—)ã«å¾“ã£ã¦ãŠã‚Š, 
æš—ã«ä¸€èˆ¬é€†è¡Œåˆ—ã¨è¨€ã£ã¦ã“ã® <span class="caps">MP</span> é€†è¡Œåˆ—ã®ã“ã¨ã‚’ç¤ºã™ã‚ˆã†ãªå ´åˆãŒå··ã§ã¯ã‚ã‚‹<sup id="fnref-6"><a class="footnote-ref" href="#fn-6">6</a></sup>.</p>
<div class="panel panel-default">
  <div class="panel-heading def"><a name="MPPseudoInverse" class="disabled">Moore-Penrose ä¸€èˆ¬é€†è¡Œåˆ—</a></div>
  <div class="panel-body" style="overflow:scroll">
  æ¬¡ã®ã™ã¹ã¦ã®æ¡ä»¶ã‚’æº€ãŸã™<a href="#GeneralizedInverse">ä¸€èˆ¬é€†è¡Œåˆ—</a> &#92;(X^{\dagger}&#92;) ã¯ 
  Moore-Penrose ä¸€èˆ¬é€†è¡Œåˆ—(<span class="caps">MP</span> é€†è¡Œåˆ—)ã¨ã„ã„, 
  ãã®å­˜åœ¨ã¯ä¸€æ„<sup id="fnref-7"><a class="footnote-ref" href="#fn-7">7</a></sup>ã§ã‚ã‚‹.
    \begin{eqnarray}
    X X^\dagger X&=&X\label{eq:sixth}\tag{6} &#92;\
    X^{\dagger}X X^{\dagger}&=&X^{\dagger}\label{eq:seventh}\tag{7} &#92;\
    \left(X^{\dagger}X\right)^T&=&X^{\dagger}X\label{eq:eigth}\tag{8} &#92;\
    \left(X X^{\dagger}\right)^T&=&X X^{\dagger}\label{eq:ninth}\tag{9}
    \end{eqnarray}
  </div>
</div>

<h4>æœ€å°äºŒä¹—å½¢ä¸€èˆ¬é€†è¡Œåˆ—</h4>
<p>ã¾ãš, ã‚±ãƒ¼ã‚¹ 2 ã®å ´åˆã«ã¤ã„ã¦è€ƒãˆã‚‹. ã“ã‚Œã¯, æœ€å°äºŒä¹—å½¢ä¸€èˆ¬é€†è¡Œåˆ—ã¨ã„ã‚ã‚Œã‚‹ä¸€èˆ¬é€†è¡Œåˆ—ã‚’ç”¨ã„ã‚‹.
ã“ã‚ŒãŒå®šã‚ã‚‹&#8221;é©å½“ã§ã‚ã‚‹ã‚ˆã†ãª&#8221;è§£ã¨ã¯, ãã®åã®é€šã‚Š, ã™ã¹ã¦ã®æ–¹ç¨‹å¼ã®äºŒä¹—èª¤å·®ãŒæœ€å°ã§ã‚ã‚‹å€¤ã§ã‚ã‚Š,&nbsp;ã¾ã•ã—ãä¸Šã§è¿°ã¹ãŸæœ€å°äºŒä¹—æ³•ã®å€¤ã§ã‚ã‚‹.</p>
<div class="panel panel-default">
  <div class="panel-heading def"><a name="LeastSquaresGeneralizedInverse" class="disabled">æœ€å°äºŒä¹—å½¢ä¸€èˆ¬é€†è¡Œåˆ—</a></div>
  <div class="panel-body" style="overflow:scroll">
  æ­£è¦æ–¹ç¨‹å¼ &#92;[\boldsymbol{a}=X^-\boldsymbol{y}&#92;] ã®è§£ 
  &#92;(\boldsymbol{a}&#92;) ã‚’äºŒä¹—èª¤å·®æœ€å°ã®å€¤ã§å®šã‚ã‚‹
  <a href="#GeneralizedInverse">ä¸€èˆ¬é€†è¡Œåˆ—</a> 
  &#92;[^\exists X^-\in\mathbb{R}^{m\times n&#8217;}\ {\rm s.t.}\ m\gt n&#8217;\land\left(X X^-\right)^T = X X^-&#92;] 
  ã¯ &#92;(X&#92;) ã®æœ€å°äºŒä¹—å½¢ä¸€èˆ¬é€†è¡Œåˆ—ã§ã‚ã‚‹.
  </div>
</div>

<p>ä»¥ä¸‹, æœ€å°äºŒä¹—å½¢ä¸€èˆ¬é€†è¡Œåˆ—ã®å®šå¼ã‚’æ±‚ã‚ã‚‹ãŒ, ä¸Šã§æ—¢ã«è¿°ã¹ãŸå†…å®¹ã¨æœ¬è³ªçš„ã«ã¯å…¨ãå¤‰ã‚ã‚‰ãªã„. 
ã“ã“ã§, å°‘ã—æ‰±ã„ã‚„ã™ãã™ã‚‹ãŸã‚ã«, \(n\) æ¬¡å¤šé …å¼ã‚’ \(f_n(x)=a_0x^0_i+a_1x^1_i+\cdots+a_nx^n_i=\sum^{n}_{j=0}a_jx^j_i\),
\(\eqref{eq:fifth}\) ã® \(x_i^j\) ã«ã¤ã„ã¦ã®è¡Œåˆ—ã‚’ \(X\) ã¨ã™ã‚‹. ãã—ã¦ãã® \(i\) è¡Œç›®ã‚’ 1 ã¤ã®ç¸¦ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ãŸã‚‚ã®ã‚’ 
\(\boldsymbol{x_i}\) (\({\rm e.g.}\ \ \boldsymbol{x_1}=\left(x_1^0, x_1^1, \cdots, x_1^n \right)^T\)) ã¨ã—,
\(\eqref{eq:fourth}\)&nbsp;ã®å¼ã‚’</p>
<p>\[\epsilon=\sum_{i=1}^{m}\left(y_i-f_n(\boldsymbol{x_i})\right)^2\label{eq:twelth}\tag{10}\]</p>
<p>ã¨ã„ã†ã‚ˆã†ã«è¡¨ã™(ã“ã‚Œã¯ \(\eqref{eq:fourth}\) ã¨å…¨ãåŒã˜ã“ã¨ã‚’æ›¸ã„ãŸã ã‘ã§ã‚ã‚‹)ã¨ã™ã‚‹.
\(f(\boldsymbol{x_i})=\boldsymbol{x_i}^T\boldsymbol{a}\)&nbsp;ã ã‹ã‚‰</p>
<p>\[=\sum_{i=1}^{m}\left(y_i-\boldsymbol{x_i}^T\boldsymbol{a}\right)^2\]</p>
<p>\(\left(\boldsymbol{x_1}^T,\boldsymbol{x_2}^T,\cdots,\boldsymbol{x_m}^T\right)^T=X\)&nbsp;ãªã®ã§</p>
<p>\[=\left(\boldsymbol{y}-X\boldsymbol{a}\right)^T\left(\boldsymbol{y}-X\boldsymbol{a}\right)\]</p>
<p>ã“ã“ã§, å…ˆã«ã‚„ã£ãŸ, åå¾®åˆ†ã‚’è€ƒãˆã‚‹ã“ã¨ã§ä¸‹ã«å‡¸ãªäºŒæ¬¡é–¢æ•°ã¨ãªã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—, ãã®å€¤ã‚’ \(0\) ã¨ã—ãŸä¸Šã§ãã‚Œã‚‰ã™ã¹ã¦ã®é€£ç«‹æ–¹ç¨‹å¼ã‚’æ±‚ã‚, æœ€å°å€¤ã‚’å¾—ãŸã“ã¨ã‚’æ€ã„ã ã—,
ã“ã®å¼ã‚’ \(\boldsymbol{a}\) ã§å¾®åˆ†ã™ã‚‹(ã™ã¹ã¦ã® \(\boldsymbol{a_i}\) ã§åå¾®åˆ†ã™ã‚‹,&nbsp;ã™ãªã‚ã¡å‹¾é…ã‚’æ±‚ã‚ã‚‹)ã¨</p>
<p>\[\nabla\epsilon\left(\boldsymbol{a}\right)=2X^T&nbsp;X\boldsymbol{a}-2X^T\boldsymbol{y}=-2X^T\left(\boldsymbol{y}-X\boldsymbol{a}\right)\]</p>
<p>\(\nabla\epsilon(\boldsymbol{a})=0\)&nbsp;ã¨ãŠãã¨, </p>
<p>\[X^T&nbsp;X\boldsymbol{a}=X^T\boldsymbol{y}\]</p>
<p>ã¨æ­£è¦æ–¹ç¨‹å¼ãŒæ±‚ã¾ã£ãŸ.
ã“ã“ã§, \(n&#8217;=m-1\) ã®ã¨ã \(X\) ã¯ãƒ´ã‚¡ãƒ³ãƒ‡ãƒ«ãƒ¢ãƒ³ãƒ‰è¡Œåˆ—<sup id="fnref2-3"><a class="footnote-ref" href="#fn-3">3</a></sup>ã¨ãªã‚Š, \(\boldsymbol{x_1}, \cdots, \boldsymbol{x_m}\) ãŒç›¸ç•°ãªã‚‹ã¨ã \(X\) ã¯æ­£å‰‡ã¨ãªã‚‹.
å¾“ã£ã¦,&nbsp;æ­£è¦æ–¹ç¨‹å¼ã®è§£ã¯</p>
<p>\[\boldsymbol{a}=\left(X^T X\right)^{-1}X^T&nbsp;\boldsymbol{y}={X}^{-1}\boldsymbol{y}\]</p>
<p>ã¨ã‹ã‘ã‚‹. \(n&#8217;\lt m-1\) ãªã‚‰ã°è¡Œåˆ— \(X^T X\) ãŒæ­£å‰‡ãªã®ã§,&nbsp;æ­£è¦æ–¹ç¨‹å¼ã®è§£ã¯</p>
<p>\[\boldsymbol{a}=\left(X^T&nbsp;X\right)^{-1}X^T\boldsymbol{y}\label{eq:tenth}\tag{11}\]</p>
<p>ã¨ã‹ã‘ã‚‹. 
ã“ã®ã¨ã \(m\lt n\) ãªã‚‰ã°, \(X^T X\) ãŒéæ­£å‰‡ã¨ãªã£ã¦ã—ã¾ã†ã‹ã‚‰, æœ€å°äºŒä¹—å½¢ä¸€èˆ¬é€†è¡Œåˆ—ã¯æ§‹æˆã§ããªã„. ã“ã®çµæœã‹ã‚‰, æ™‚é–“è¨ˆç®—é‡ã¯å¤šé …å¼æ™‚é–“ \(\mathrm{O}(n^3)\) ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹. 
ã¾ãŸ, æœ€å°äºŒä¹—å½¢ä¸€èˆ¬é€†è¡Œåˆ—ã¯, <a href="#MPPseudoInverse"><span class="caps">MP</span> é€†è¡Œåˆ—</a>ã§ã‚ã‚‹ã“ã¨ãŒå°å‡ºã§ãã‚‹<sup id="fnref-8"><a class="footnote-ref" href="#fn-8">8</a></sup>.</p>
<h4>æœ€å°ãƒãƒ«ãƒ å½¢ä¸€èˆ¬é€†è¡Œåˆ—</h4>
<p>æ¬¡ã«, ã‚±ãƒ¼ã‚¹ 3 ã®å ´åˆã‚’è€ƒãˆã‚‹. ã“ã®å ´åˆ, æœ€å°ãƒãƒ«ãƒ å½¢ä¸€èˆ¬é€†è¡Œåˆ—ã‚’ç”¨ã„ã‚‹.
ã‚±ãƒ¼ã‚¹ 3 ã¯æ§˜ã€…ãªå€¤ãŒè§£ã«ãªã‚Šã†ã‚‹ã¨ã„ã†ã“ã¨ã§ã‚ã£ãŸãŒ, 
æœ€å°ãƒãƒ«ãƒ å½¢ä¸€èˆ¬é€†è¡Œåˆ—ã¯, ã„ã¾ãã‚Œã‚’ \(X^-\) ã¨ã—ãŸã¨ã,
\(\boldsymbol{a}=X^-\boldsymbol{y}\) ã®è§£ \(\boldsymbol{a}\) ã‚’
ãã® \(L^2\) ãƒãƒ«ãƒ  \(\mid\mid \boldsymbol{a}\mid\mid_2\)&nbsp;ãŒæœ€å°ã¨ãªã‚‹ã‚ˆã†ã«å®šã‚ã‚‹.</p>
<div class="panel panel-default">
  <div class="panel-heading def"><a name="MinimumNormGeneralizedInverse" class="disabled">æœ€å°ãƒãƒ«ãƒ å½¢ä¸€èˆ¬é€†è¡Œåˆ—</a></div>
  <div class="panel-body" style="overflow:scroll">
  æ­£è¦æ–¹ç¨‹å¼ &#92;[\boldsymbol{a}=X^-\boldsymbol{y}&#92;] ã®è§£ 
  &#92;(\boldsymbol{a}&#92;) ã‚’ãã® &#92;(L^2&#92;) ãƒãƒ«ãƒ  &#92;(\mid\mid \boldsymbol{a}\mid\mid_2&#92;)
  ãŒæœ€å°ã¨ãªã‚‹å€¤ã§å®šã‚ã‚‹<a href="#GeneralizedInverse">ä¸€èˆ¬é€†è¡Œåˆ—</a> 
  &#92;[^\exists X^-\in\mathbb{R}^{m\times n&#8217;}\ {\rm s.t.}\ m\lt n&#8217;\land\left(X^- X\right)^T = X^- X&#92;]
  ã¯ &#92;(X&#92;) ã®æœ€å°ãƒãƒ«ãƒ å½¢ä¸€èˆ¬é€†è¡Œåˆ—ã§ã‚ã‚‹.
  </div>
</div>

<p>ã¤ã¾ã‚Š,&nbsp;è§£ãã¹ãã¯æ¬¡ã«ç¤ºã™åˆ¶ç´„ä»˜ãæœ€é©åŒ–å•é¡Œ/æ¡ä»¶ä»˜ãæ¥µå°å€¤å•é¡Œã§ã‚ã‚‹.</p>
<p>\[\min_{\boldsymbol{a}}\mid\mid\boldsymbol{a}\mid\mid^2_2\ {\rm s.t.}\&nbsp;\boldsymbol{y}=X\boldsymbol{a}\]</p>
<p>æ¡ä»¶ä»˜ãæ¥µå€¤ã®å•é¡Œã¯ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã§è§£ã‘ã‚‹.
ã“ã®è¨¼æ˜ã¯ä¸­ã€…å¤§å¤‰ãªã®ã§, æœ¬ã‚¨ãƒ³ãƒˆãƒªã§ã¯å…¬ç†ã¨ã—ã¦èªã‚ãŸä¸Šã§ç”¨ã„ã‚‹ã“ã¨ã¨ã™ã‚‹(<span class="caps">TODO</span>).
å¾“ã£ã¦,&nbsp;ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ã‚¢ãƒ³ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹.</p>
<p>\[\mathcal{L}(\boldsymbol{a},&nbsp;\boldsymbol{\lambda}):=\mid\mid\boldsymbol{a}\mid\mid^2_2+\boldsymbol{\lambda}^T\left(\boldsymbol{y}-X\boldsymbol{a}\right)\]</p>
<p>ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã«å¾“ã„,&nbsp;ãã‚Œãã‚Œã®åå°é–¢æ•°ã‹ã‚‰æ±‚ã‚ã¦</p>
<div class="math">\begin{eqnarray}
\begin{cases}
\frac{\partial}{\partial\boldsymbol{a}}\mathcal{L}(\boldsymbol{a})&amp;=&amp;2\boldsymbol{a}-X^T\boldsymbol{\lambda}&amp;=&amp;0 \\\
\frac{\partial}{\partial\boldsymbol{\lambda}}\mathcal{L}(\boldsymbol{a})&amp;=&amp;\boldsymbol{y}-X\boldsymbol{a}&amp;=&amp;0
\end{cases}
\end{eqnarray}</div>
<p>ã‚ˆã£ã¦</p>
<div class="math">\begin{eqnarray}
\begin{cases}
\boldsymbol{a}&amp;=&amp;\frac{1}{2}X^T\lambda \\\
\boldsymbol{y}&amp;=&amp;X\boldsymbol{a}
\end{cases}\leftrightarrow\boldsymbol{y}=\frac{1}{2}X X^T\lambda
\end{eqnarray}</div>
<p>\(m\lt n&#8217;\) ãªã‚‰ã° \(X X^T\)&nbsp;ã¯æ­£å‰‡ãªã®ã§</p>
<p>\[\lambda=2\left(X X^T\right)^{-1}\boldsymbol{y}\leftrightarrow \boldsymbol{a}=X^T\left(X&nbsp;X^T\right)^{-1}\boldsymbol{y}\]</p>
<p><span class="math">\(X\boldsymbol{a}=X\left\{X^T\left(X X^T\right)^{-1}\boldsymbol{y}\right\}=\left(X X^T\right)\left(X X^T\right)^{-1}\boldsymbol{y}=\boldsymbol{y}\)</span>&nbsp;ã‚ˆã‚Šã“ã®æ­£è¦æ–¹ç¨‹å¼ã®è§£ãŒä¸€èˆ¬é€†è¡Œåˆ—ã¨ã—ã¦æˆç«‹ã—ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã‚‹.</p>
<h4>åˆ¶é™ã¤ãæœ€å°äºŒä¹—æ³•</h4>
<p>æœ€å¾Œã«, é‡è¤‡ãŒã‚ã‚‹(ãƒ©ãƒ³ã‚¯è½ã¡ã§ã‚ã‚‹)ã‚±ãƒ¼ã‚¹ã‚’è€ƒãˆã‚‹.
ã“ã®å ´åˆã¯, \(X^T X, X X^T\) ãŒã¨ã‚‚ã«ç‰¹ç•°è¡Œåˆ—ã¨ãªã£ã¦ã—ã¾ã†ãŸã‚,
å¯¾è±¡ã®è¡Œåˆ—ã«å¯¾ã—ã¦ã¾ãšç‰¹ç•°å€¤åˆ†è§£(ä»¥ä¸‹ <span class="caps">SVD</span>)ã‚’è¡Œã†.</p>
<div class="panel panel-default">
  <div class="panel-heading def"><a name="SVD" class="disabled">ç‰¹ç•°å€¤åˆ†è§£</a></div>
  <div class="panel-body" style="overflow:scroll">
&#92;(^\forall X\in\mathbb{R}^{m\times n&#8217;}&#92;) ã«å¯¾ã—ã¦
&#92;[
 ^\exists U\in\mathbb{R}^{m\times m}, ^\exists V\in\mathbb{R}^{n&#8217;\times n&#8217;},
 ^\exists \Sigma\in\mathbb{R}^{n&#8217;\times m}\ {\rm s.t.}\ 
X = U\Sigma V^T &#92;\ {\rm where}\ \Sigma=\left( 
                      \begin{array}{ccccc}
                             \lambda_1&\cdots&0 &#92;\ 
                             \vdots&\ddots&\vdots &#92;\
                             0&\cdots&\lambda_{r} &#92;\
                             &&&0 &#92;\
                             &&&&0
                      \end{array}
              \right), \lambda_1\geq\cdots\geq\lambda_{r}\geq 0,
              r=\mathrm{rank}(X)=\min(m,n&#8217;)
&#92;]
ã“ã®ã¨ã &#92;(U\Sigma V^T&#92;) ã‚’ &#92;(X&#92;) ã®ç‰¹ç•°å€¤åˆ†è§£(è‹±: Singular value decomposition)ã¨ã„ã†.

  </div>
</div>

<p>ã“ã‚Œã¯ </p>
<div class="math">\begin{eqnarray}
\displaystyle\sum^{r}_{i=1}\lambda_i\boldsymbol{u_i}\boldsymbol{v_i}^T\ {\rm where}
\ \begin{array}{cc}
\left(\boldsymbol{u_1},\cdots,\boldsymbol{u_m}\right)^T
&amp;=&amp;\left(\begin{array}{ccc}
u_{11}&amp;\cdots&amp;u_{1m} \\\
\vdots&amp;\ddots&amp;\vdots\\\ 
u_{m1}&amp;\cdots&amp;u_{mm}
\end{array}\right)&amp;=&amp;U \\\
\left(\boldsymbol{v_1},\cdots,\boldsymbol{v_{n'}}\right)^T
&amp;=&amp;\left(\begin{array}{ccc}
v_{11}&amp;\cdots&amp;v_{1n'} \\\
\vdots&amp;\ddots&amp;\vdots\\\
v_{n'1}&amp;\cdots&amp;v_{n'n'}
\end{array}\right)&amp;=&amp;V
\end{array}
\end{eqnarray}</div>
<p>ã¨åŒå€¤ã§ã‚ã‚Š, ä¸€èˆ¬ã« \(\lambda_i\) ã‚’ç‰¹ç•°å€¤, \(\boldsymbol{u_i}\) ã‚’å·¦ç‰¹ç•°ãƒ™ã‚¯ãƒˆãƒ«
\(\boldsymbol{v_i}\)&nbsp;ã‚’å³ç‰¹ç•°ãƒ™ã‚¯ãƒˆãƒ«ã¨ã„ã†.</p>
<p><strong><span class="caps">TODO</span>:&nbsp;è©³è§£ã‚’è¿½è¨˜</strong></p>
<h4>ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã¨æ­£å‰‡åŒ–ãŠã‚ˆã³ãã®è©•ä¾¡</h4>
<p>å…ˆã«, æ¬¡æ•°ã«å¿œã˜ãŸè¿‘ä¼¼ã®é·ç§»ãŒè¦³å¯Ÿã§ãã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¤ºã—ãŸãŒ, ã‚ã¾ã‚Šæ¬¡æ•°ã‚’å¤§ããã™ã‚‹ã¨, ãƒ‡ãƒ¼ã‚¿ç‚¹ã®é–“ã§èª¤å·®ãŒå¤§ãããªã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹. ã“ã‚Œã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã¨ã„ã†.
å…ˆã¨åŒæ§˜, \(x_i=i-1, y_i=\sin(x_i)+\epsilon, i=1,2,\cdots,11\) ã«å¯¾ã™ã‚‹å„æ¬¡å…ƒã§ã®ä¿‚æ•°ã‚’è¦‹ã¦ã¿ã‚‹ã¨(\(\eqref{eq:fifth}\) ã§ã¯, 
ä¿‚æ•°ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’ \(\left(a_0,a_1,\cdots,a_n\right)^T\) ã¨ä¸¦ã¹ã¦ã„ã‚‹ãŒ, ä¸‹è¨˜ã¯ \(\left(a_n,a_{n-1},\cdots,a_0\right)^T\)&nbsp;ã®é †ã§ã‚ã‚‹),</p>
<div class="highlight"><pre><span></span><span class="nf">Î»</span><span class="o">&gt;</span> <span class="kt">:</span><span class="n">m</span> <span class="o">+</span><span class="kt">Data</span><span class="o">.</span><span class="kt">Tuple</span><span class="o">.</span><span class="kt">Extra</span> <span class="kt">Data</span><span class="o">.</span><span class="kt">Maybe</span> <span class="kt">System</span><span class="o">.</span><span class="kt">Random</span> <span class="kt">Random</span><span class="o">.</span><span class="kt">Normal</span> <span class="kt">Control</span><span class="o">.</span><span class="kt">Monad</span> <span class="kt">ML</span><span class="o">.</span><span class="kt">Approx</span><span class="o">.</span><span class="kt">OLS</span><span class="o">.</span><span class="kt">ByPinv</span> <span class="kt">Utils</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">uni</span> <span class="ow">=</span> <span class="n">normalIO&#39;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">d</span> <span class="ow">=</span> <span class="n">zipWith</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">y</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sin</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">))</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="o">&lt;$&gt;</span> <span class="n">replicateM</span> <span class="mi">11</span> <span class="n">uni</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">dd</span> <span class="ow">&lt;-</span> <span class="n">d</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">dd</span>
<span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">5.563765361160251e-4</span><span class="p">),(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.9418472638241775</span><span class="p">),(</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">1.1378051539092622</span><span class="p">),(</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">0.30341406458452413</span><span class="p">),(</span><span class="mf">4.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.8411970236084821</span><span class="p">),(</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.8558604338359868</span><span class="p">),(</span><span class="mf">6.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2586281201459223</span><span class="p">),(</span><span class="mf">7.0</span><span class="p">,</span><span class="mf">0.8031257237891795</span><span class="p">),(</span><span class="mf">8.0</span><span class="p">,</span><span class="mf">1.1562504257723663</span><span class="p">),(</span><span class="mf">9.0</span><span class="p">,</span><span class="mf">0.39633872602316167</span><span class="p">),(</span><span class="mf">10.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.8085898217611907</span><span class="p">)]</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">outCoes</span> <span class="n">i</span> <span class="ow">=</span> <span class="n">putStrLn</span> <span class="o">$</span> <span class="n">maybe</span> <span class="s">&quot;failed&quot;</span> <span class="p">(((</span><span class="o">++</span><span class="p">)</span> <span class="o">$</span> <span class="n">show</span> <span class="n">i</span> <span class="o">++</span> <span class="s">&quot; -----</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="n">foldr1</span> <span class="p">(</span><span class="o">++</span><span class="p">)</span> <span class="o">.</span> <span class="p">(</span><span class="n">map</span> <span class="p">((</span><span class="o">++</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="n">show</span><span class="p">)))</span> <span class="o">$</span> <span class="n">resolve</span> <span class="n">i</span> <span class="n">dd</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">mapM_</span> <span class="n">outCoes</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span>
<span class="mi">1</span> <span class="c1">-----</span>
<span class="p">[</span><span class="o">-</span><span class="mf">4.168066672607503e-2</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.38785329563173637</span><span class="p">]</span>

<span class="mi">2</span> <span class="c1">-----</span>
<span class="p">[</span><span class="mf">6.311957210780993e-3</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.10480023883388496</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.4825326537934513</span><span class="p">]</span>

<span class="p">(</span><span class="err">ç•¥</span><span class="p">)</span>

<span class="mi">9</span> <span class="c1">-----</span>
<span class="p">[</span><span class="mf">6.2497127164502315e-6</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">2.783924911591259e-4</span><span class="p">]</span>
<span class="p">[</span><span class="mf">5.143290075166487e-3</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">5.026523522855991e-2</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.2724261548894942</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.7770268952402895</span><span class="p">]</span>
<span class="p">[</span><span class="mf">1.0147233691594897</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.7860963186273294</span><span class="p">]</span>
<span class="p">[</span><span class="mf">1.2602569068891822</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">2.3687551597216985e-4</span><span class="p">]</span>

<span class="mi">10</span> <span class="c1">-----</span>
<span class="p">[</span><span class="o">-</span><span class="mf">1.626701126479776e-5</span><span class="p">]</span>
<span class="p">[</span><span class="mf">8.196002759563384e-4</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">1.7705498506683254e-2</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.21421719275219878</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">1.5895590768542918</span><span class="p">]</span>
<span class="p">[</span><span class="mf">7.43609912277545</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">21.670288785218535</span><span class="p">]</span>
<span class="p">[</span><span class="mf">37.428871273332284</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">34.68074111840572</span><span class="p">]</span>
<span class="p">[</span><span class="mf">13.820707197220901</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">5.563765361160251e-4</span><span class="p">]</span>
</pre></div>


<p>\(m=10\) ã§, \(-21.670\cdots,37.428\cdots,-34.680\cdots,13.820\cdots\) ã¨ã„ã£ãŸ, çµ¶å¯¾å€¤ã®å¤§ããªå€¤ãŒè¦‹ã‚‰ã‚Œã‚‹. å®Ÿéš›ã« \(m=9, 10\)&nbsp;ã§ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã‚‹ã¨,</p>
<div class="highlight"><pre><span></span><span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">mapM_</span> <span class="p">(</span><span class="nf">\</span><span class="n">i</span> <span class="ow">-&gt;</span> <span class="n">plot</span> <span class="o">$</span> <span class="kt">PP</span> <span class="p">(</span><span class="s">&quot;./image&quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">i</span> <span class="o">++</span> <span class="s">&quot;.png&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;m = &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">i</span><span class="p">)</span> <span class="s">&quot;points&quot;</span> <span class="s">&quot;line&quot;</span> <span class="n">dd</span> <span class="o">$</span> <span class="n">fromJust</span> <span class="o">$</span> <span class="n">implicitFn</span> <span class="o">$</span> <span class="n">fromJust</span> <span class="o">$</span> <span class="n">resolve</span> <span class="n">i</span> <span class="n">dd</span><span class="p">)</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>


<p>\(m=10\) ã®ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹è¿‘ä¼¼ã¯ \(m=9\)&nbsp;ã®å ´åˆã¨æ¯”ã¹ã¦æ¿€ã—ãæŒ¯ã‚Œã¦ã„ã‚‹ã“ã¨ãŒè¦‹ã¦ã¨ã‚Œã‚‹.</p>
<p style="text-align:center">
<img src="../../../../../images/2018/November/image9.png" alt="non regulared" width="320px">
<img src="../../../../../images/2018/November/image10.png" alt="non regulared" width="320px">
</p>

<p>å¤©ä¸‹ã‚Šçš„ã«ãªã£ã¦ã—ã¾ã†ãŒ, ã“ã®ã‚ˆã†ãªç¾è±¡ã¯æ¨å®šã™ã‚‹ä¿‚æ•°ã«å¯¾ã—ã¦æ¨™æœ¬æ•°ãŒå°‘ãªã„ã‚ˆã†ãªã¨ãã«ã‚ˆãé­é‡ã™ã‚‹. ãã®ç‰¹å¾´ã¨ã—ã¦, ã„ã¾ç¤ºã—ãŸã‚ˆã†ã«, ä¿‚æ•°ã®çµ¶å¯¾å€¤ãŒå¤§ãããªã‚‹ã“ã¨ãŒæŒ™ã’ã‚‰ã‚Œã‚‹.
å¾“ã£ã¦, æ¬¡æ•°ã‚’é©å½“ã«å›ºå®šã—ãŸä¸Šã§(ã“ã®å ´åˆ \(n=\)ãƒ‡ãƒ¼ã‚¿æ•°\(-1\), ã™ãªã‚ã¡ãƒ‡ãƒ¼ã‚¿æ•°ã‹ã‚‰æ©Ÿæ¢°çš„ã«æ¬¡æ•°ã‚’æ±ºå®šã™ã‚‹), ä¿‚æ•°ã‚’çµ¶å¯¾å€¤ã‚’åˆ¶é™ã™ã‚‹ã“ã¨ãŒã§ãã‚Œã°, ã“ã‚Œã‚’é˜²ãã“ã¨ãŒã§ãã‚‹ã ã‚ã†. 
å…·ä½“çš„ãªæ‰‹æ³•ã¨ã—ã¦, å¼ \(\eqref{eq:fourth}\) ã«å¯¾ã—ã¦ãƒãƒ«ãƒ ã‚’åŠ ãˆ, ãã®æœ€å°åŒ–ã‚’æ±‚ã‚ã‚‹ã¨ã„ã£ãŸã‚ˆã†ãª<sup id="fnref-9"><a class="footnote-ref" href="#fn-9">9</a></sup>æ‰‹æ³•ãŒåºƒãçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹.
ã“ã®æ‰‹æ³•ã¯, ãƒãƒ«ãƒ ã«å¯¾ã—ã¦, æ¬¡ã®ã‚ˆã†ã«å¹³æ»‘åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ \(\lambda \geq 0\)&nbsp;ã‚’ä½œç”¨ã•ã›ã‚‹ã“ã¨ã§æ­£å‰‡åŒ–ã®å¼·åº¦ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã‚‹. </p>
<p>\[\epsilon\left(\boldsymbol{a}\right)_\lambda=\sum^m_{i=1}\left(y_i-f_n(\boldsymbol{x}_i)\right)^2+\underbrace{\lambda R\left(\boldsymbol{a}\right)}_{\rm&nbsp;æ­£å‰‡åŒ–é …}\]</p>
<p>ã“ã®ã‚ˆã†ãªæœ€é©åŒ–ã‚’æ­£å‰‡åŒ–æ³•ã¨ã„ã†.
ã“ã†ã™ã‚‹ã¨, ãƒ¢ãƒ‡ãƒ«ã®å¤‰å‹•ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦æ­£å‰‡åŒ–é …ã‚‚å¤§ãããªã‚Š, ãã‚ŒãŒæœ€å°åŒ–å•é¡Œã¸ã®ãƒšãƒŠãƒ«ãƒ†ã‚£ã¨ãªã£ã¦, çµæœçš„ã«æ»‘ã‚‰ã‹ãªæ›²ç·šã®æ¨å®šã«ç¹‹ãŒã‚‹.
ãŸã ã—, éå‰°ã«å¤§ãã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã¨ã‚‹ã¨, é«˜æ¬¡ã®é …ã¸ã®ãƒšãƒŠãƒ«ãƒ†ã‚£ãŒå¼·ããªã£ã¦ã—ã¾ã†ã“ã¨ã§, çµå±€, é«˜æ¬¡ã®é …ã‚’ç„¡è¦–ã™ã‚‹ã®ã¨åŒç­‰ã¨ãªã£ã¦ã—ã¾ã„, ä½æ¬¡ã®é–¢æ•°ã§ãƒ¢ãƒ‡ãƒ«ã‚’ä½œã‚‹ã®ã¨åŒç­‰ã«ãªã£ã¦ã—ã¾ã†. å¾“ã£ã¦, ä¾ç„¶ã¨ã—ã¦é©åˆ‡ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¨­å®šãŒè¦ã•ã‚Œã‚‹ã‚ã‘ã ãŒ,&nbsp;ãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã‚’æ±ºå®šã™ã‚‹ã‚ˆã‚Šã‹ã¯æ¥½ã§ã‚ã‚‹. </p>
<p>ã¾ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ \(\lambda\)&nbsp;ã‚’æ¨™æœ¬æ•°ã§å‰²ã£ãŸå½¢å¼ãŒå–ã‚‰ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚‹.</p>
<p>\[\epsilon\left(\boldsymbol{a}\right)_\lambda=\sum^m_{i=1}\left(y_i-f_n(\boldsymbol{x}_i)\right)^2+\underbrace{\frac{\lambda}{m} R\left(\boldsymbol{a}\right)}_{\rm&nbsp;æ­£å‰‡åŒ–é …}\]</p>
<p>ä¸¡è€…ã®é•ã„ã¯æ­£å‰‡åŒ–é …ã®å½±éŸ¿åº¦ã§ã‚ã‚‹. å…ˆã«, æ¨å®šã™ã‚‹ä¿‚æ•°ã«å¯¾ã—ã¦æ¨™æœ¬æ•°ãŒå°‘ãªã„ã‚ˆã†ãªã¨ãã«ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã¯ã‚ˆãèµ·ã“ã‚‹ã¨è¿°ã¹ãŸãŒ, ãªã‚‰ã°å½“ç„¶, æ¨™æœ¬æ•°ãŒååˆ†ã§ã‚ã‚‹å ´åˆã«ã¯æ­£å‰‡åŒ–é …ã¯å¿…è¦ãªã„. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ \(\lambda\) ã‚’æ¨™æœ¬æ•°ã§å‰²ã£ã¦ã‚„ã‚Œã°, æ¨™æœ¬æ•°ã®å¢—åŠ ã«å¾“ã£ã¦æ­£å‰‡åŒ–é …ã®å½±éŸ¿åº¦ã‚’æŠ‘åˆ¶ã§ãã‚‹.&nbsp;ã©ã¡ã‚‰ã‚’ç”¨ã„ã‚‹ã‹ã¯ãã®æ™‚ã€…ã§é¸æŠã®ä½™åœ°ãŒã‚ã‚‹ã ã‚ã†.</p>
<p>ä¾‹ãˆã°, \(\lambda\) ã‚’æ¨™æœ¬æ•°ã«ä¾ã‚‰ãšç›´æ¥ä½œç”¨ã•ã›ã‚‹å½¢å¼ã§ 
\(R\left(\boldsymbol{v}\right)\) ã‚’ \(L^2\) ãƒãƒ«ãƒ ã¨ã™ã‚‹<sup id="fnref2-9"><a class="footnote-ref" href="#fn-9">9</a></sup>ã¨,</p>
<div class="math">\begin{eqnarray}
\epsilon\left(\boldsymbol{a}\right)_\lambda&amp;=&amp;\sum^m_{i=1}\left(y_i-f_n(\boldsymbol{x}_i)\right)^2+\lambda\sum_{j=0}^{n}a^2_j \\\
&amp;=&amp;\left(\boldsymbol{y}-X\boldsymbol{a}\right)^T\left(\boldsymbol{y}-X\boldsymbol{a}\right)+\lambda\boldsymbol{a}^T\boldsymbol{a}
\end{eqnarray}</div>
<p>å…ˆã¨åŒæ§˜ã« \(\nabla\epsilon\left(\boldsymbol{a}\right)_\lambda=0\)&nbsp;ã¨ãŠã„ã¦,</p>
<div class="math">\begin{eqnarray}
\nabla\epsilon\left(\boldsymbol{a}\right)_\lambda&amp;=&amp;-2X^T\left(\boldsymbol{y}-X\boldsymbol{a}\right)+2\lambda\boldsymbol{a} \\\
&amp;=&amp;2\left(\lambda I+X^T X\right)\boldsymbol{a}-2X^T\boldsymbol{y}\\\ &amp;=&amp;0
\end{eqnarray}</div>
<p>å¾“ã£ã¦ã“ã®æ­£è¦æ–¹ç¨‹å¼ã®è§£ã¯,</p>
<p>\[\boldsymbol{a}=\left(\lambda I+X^T&nbsp;X\right)^{-1}X^T\boldsymbol{y}\]</p>
<p>ã¨ãªã‚‹. \(\boldsymbol{a}\) ã‚’æ±‚ã‚ã‚‹ã«éš›ã™ã‚‹æ™‚é–“è¨ˆç®—é‡ã«ã¤ã„ã¦åŠ å‘³ã™ã‚‹ã¨,
é€†è¡Œåˆ—ã‚’è¨ˆç®—ã™ã‚‹ã‚ˆã‚Šã‚‚ <span class="caps">LU</span>&nbsp;åˆ†è§£ã‚’è¡Œã£ãŸæ–¹ãŒè‰¯ã„ã®ã§,</p>
<p>\[\left(\lambda I+X^T&nbsp;X\right)\boldsymbol{a}=X^T\boldsymbol{y}\]</p>
<p>ã¨ã—ã¦ãŠã. ã“ã®æ­£è¦æ–¹ç¨‹å¼ã‚’ç”¨ã„ã¦, å¹³æ»‘åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ \(\lambda=0.1,1,10\)&nbsp;ã‚’é©ç”¨ã—ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã¨,</p>
<div class="highlight"><pre><span></span><span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">mapM_</span> <span class="p">(</span><span class="nf">\</span><span class="n">i</span> <span class="ow">-&gt;</span> <span class="n">plot</span> <span class="o">$</span> <span class="kt">PP</span> <span class="p">(</span><span class="s">&quot;./image&quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">i</span> <span class="o">++</span> <span class="s">&quot;.png&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;parameter = &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">i</span><span class="p">)</span> <span class="s">&quot;points&quot;</span> <span class="s">&quot;line&quot;</span> <span class="n">dd</span> <span class="o">$</span> <span class="n">fromJust</span> <span class="o">$</span> <span class="n">implicitFn</span> <span class="o">$</span> <span class="n">fromJust</span> <span class="o">$</span> <span class="n">resolveRegular</span> <span class="n">i</span> <span class="n">dd</span><span class="p">)</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>


<p>æ¬¡ã®ã‚ˆã†ã«ãªã‚‹.</p>
<p style="text-align:center">
<img src="../../../../../images/2018/November/image0.1.png" alt="regulared 0.1" width="320px">
<img src="../../../../../images/2018/November/image1.0.png" alt="regulared 1.0" width="320px">
<img src="../../../../../images/2018/November/image10.0.png" alt="regulared 10.0" width="320px">
</p>

<p>å•é¡Œã¯, ã©ã®ã‚ˆã†ã«ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’è©•ä¾¡ã™ã‚‹ã‹ã§ã‚ã‚‹.
ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ \(\bf x\) ã«å¯¾ã—, çœŸã®å€¤ \(t_i\) ã‚’
<span class="math">\(D=\left\{\left({\bf x_1},t_1\right), \left({\bf x_2},t_2\right),\cdots,\left({\bf x_m},t_m\right)\right\} {\rm where}\ t_i=g+u_i\ \left(\because\ \eqref{eq:ssecond}\ {\text ã‚ˆã‚Š}\right)\)</span> 
ã¨ã—, å›å¸°åˆ†æã«ã‚ˆã£ã¦å¾—ã‚‰ã‚Œã‚‹ãƒ¢ãƒ‡ãƒ«
\(\hat{f}_n({\bf y_i})=f_n(\boldsymbol{x&#8217;_i})\ {\rm where}\ \boldsymbol{x&#8217;_i}=\left({\bf y_i^0},{\bf y_i^1},\cdots,{\bf y_i^n}\right)^T \left(\because \eqref{eq:twelth}\ {\text ã‚ˆã‚Š}\right)\)&nbsp;ã¨ã®å·®ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹.</p>
<p>\[L\left(t_i, \hat{f}_n(\boldsymbol{{\bf x_i}})\right):=\left(t_i-\hat{f}_n(\boldsymbol{{\bf&nbsp;x_i}})\right)^2\]</p>
<p>ã“ã® \(L\) ã¯æå¤±é–¢æ•°ã¨ã„ã‚ã‚Œã‚‹. 
ã“ã“ã§, \(\bf x_i\) ã¨ \(t_i\) ãŒå¾—ã‚‰ã‚Œã‚‹åŒæ™‚ç¢ºç‡ã‚’è€ƒæ…®ã™ã‚‹ã¨,&nbsp;æå¤±ã®æœŸå¾…å€¤ã¯</p>
<div class="math">\begin{eqnarray}
E\left[L\left(t_i, \hat{f}_n({\bf x_i})\right)\right]&amp;=&amp;
\int\int\left(t_i-\hat{f}_n({\bf x_i})\right)^2P\left(t_i\cap{\bf x_i}\right)dt_id{\bf x_i} \\\
&amp;=&amp;\int\left\{\int\left(t_i-\hat{f}_n({\bf x_i})\right)^2P\left(t_i\mid{\bf x_i}\right)dt_i\right\}P\left({\bf x_i}\right)d{\bf x_i}\ \left(\because \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#MulTheoremConditionalProbability}{\text æ¡ä»¶ä»˜ãç¢ºç‡ã®ä¹—æ³•å®šç†}\right)
\end{eqnarray}</div>
<p>\(\int\left(t_i-\hat{f}_n({\bf x_i})\right)^2P\left(t_i|{\bf x_i}\right)\) 
ã‚’æœ€å°åŒ–ã—ãŸã„ã®ã§, 
ã“ã‚Œã‚’ \(g({\bf y})=\int\left(t_i-\hat{f}_n({\bf y_i})\right)^2P\left(t_i|{\bf y_i}\right)\)&nbsp;ã¨ãŠã„ã¦</p>
<div class="math">\begin{eqnarray}
\frac{\partial}{\partial \hat{f}_n({\bf x_i})} g({\bf x_i})&amp;=&amp;2\int\left(t_i-\hat{f}_n({\bf x_i})\right)P\left(t\mid{\bf x_i}\right)dt_i \\\
&amp;=&amp;2\int\left\{\hat{f}_n({\bf x_i})P\left(t_i\mid{\bf x_i}\right)\right\}dt_i-2\int t_i P\left(t_i\mid{\bf x_i}\right)dt_i \\\
&amp;=&amp;2\hat{f}_n({\bf x_i})\int P\left(t_i\mid{\bf x_i}\right)dt_i-2\int t_i P\left(t_i\mid{\bf x_i}\right)dt_i \\\
&amp;=&amp;2\hat{f}_n({\bf x_i})-2\int t_i P\left(t_i\mid {\bf x_i}\right)dt_i\ \left(\because \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#normalizationLaw}{\text è¦æ ¼åŒ–æ¡ä»¶}\right)
\end{eqnarray}</div>
<p>\(\therefore\)</p>
<div class="math">$$
\nabla g({\bf x})=0\leftrightarrow \hat{f}_n({\bf x_i})=\int t_i P\left(t_i\mid{\bf x_i}\right)=E\left[t_i\mid{\bf x_i}\right]
$$</div>
<p>ã‚ˆã£ã¦, \(\hat{f}_n\) ã¯æ¡ä»¶ä»˜ãæœŸå¾…å€¤ <span class="math">\(E\left[t_i\mid{\bf x_i}\right]\)</span> 
ã§æ±ºã‚ã‚‹ã¨æœ€å°åŒ–ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸ. å…ˆã«ç¤ºã—ãŸæå¤±é–¢æ•° \(L\) ã¯, ä¸€ã¤ã®ç‚¹ã«ãŠã‘ã‚‹å·®ãªã®ã§, 
ã™ã¹ã¦ã®ç‚¹ã«ãŠã‘ã‚‹å·®ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹(è‹±: mean-square error&nbsp;ã‹ã‚‰).</p>
<div class="math">$${\rm MSE}:=\sum^m_{i=1}L\left(t_i,\hat{f}_n({\bf x_i})\right)$$</div>
<p>ã“ã®æœŸå¾…å€¤ã‚’ã§ãã‚‹é™ã‚Šå°ã•ãã—ãŸã„.</p>
<div class="math">$$E\left[{\rm MSE}\right]=E\left[\sum^m_{i=1}L\left(t_i,\hat{f}_n({\bf x})\right)\right]=\sum_{i=1}^mE\left[L\left(t_i,\hat{f}_n({\bf x})\right)\right]\ \left(\because \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#fn-2}{\text æœŸå¾…å€¤ã®ç·šå½¢æ€§}\right)$$</div>
<p><span class="math">\(E\left[L\left(t_i,\hat{f}_n({\bf x_i})\right)\right]\)</span>&nbsp;ã«ã¤ã„ã¦å±•é–‹ã™ã‚‹ã¨,</p>
<div class="math">\begin{eqnarray}
E\left[L\left(t_i,\hat{f}_n({\bf x_i})\right)\right]&amp;=&amp;
E\left[\left(t_i-\hat{f}_n({\bf x_i})\right)^2\right] \\\
&amp;=&amp;E\left[\left(t_i-E\left[t_i\mid{\bf x_i}\right]+E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)^2\right] \left(\because {\rm augmentation\ trick}\right)\\\
&amp;=&amp;E\left[\left\{\underbrace{\left(t_i-E\left[t_i\mid{\bf x_i}\right]\right)}_{a}+\underbrace{\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)}_{b}\right\}^2\right] \\\
&amp;=&amp;E\left[
\begin{array}{c}
\left(t_i-E\left[t_i\mid{\bf x_i}\right]\right)^2+ \\\
\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)^2+ \\\
2\left(t_i-E\left[t_i\mid{\bf x_i}\right]\right)\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)
\end{array}\ 
\right] \left(\because \left(a+b\right)^2=a^2+b^2+2ab\label{eq:thirteenth}\tag{12}\right) \\\
&amp;=&amp;
\begin{array}{c}
E\left[\left(t_i-E\left[t_i\mid{\bf x_i}\right]\right)^2\right] \\\
+E\left[\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)^2\right] \\\
+E\left[2\left(t_i-E\left[t_i\mid{\bf x_i}\right]\right)\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)\right]
\end{array}
\left(\because \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#fn-2}{\text æœŸå¾…å€¤ã®ç·šå½¢æ€§}\right)
\end{eqnarray}</div>
<p>ç¬¬ä¸‰é …ã«ã¤ã„ã¦</p>
<div class="math">\begin{eqnarray}
E\left[2\left(t_i-E\left[t_i\mid{\bf x_i}\right]\right)\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x})\right)\right]&amp;=&amp;2\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x})\right)E\left[\left(t_i-g\right)\right]\ \left(\because \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#mjx-eqn-eq%3Aexaxiom3}{E\left[a A\right]=a E\left[A\right]}\right) \\\
&amp;=&amp;2\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x})\right)\left(E\left[t_i\right]-E\left[E\left[t_i\mid{\bf x_i}\right]\right]\right)\ \left(\because \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#fn-2}
{\text æœŸå¾…å€¤ã®ç·šå½¢æ€§}\right) \\\
&amp;=&amp;2\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x})\right)\left(E\left[t_i\right]-E\left[t_i\right]\right) \ \left(\because \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#fn-4}{E\left[B\right]=E\left[E\left[B\mid A\right]\right]}\right) \\\
&amp;=&amp;0
\end{eqnarray}</div>
<p>\(\therefore\)</p>
<div class="math">\begin{eqnarray}
E\left[L\left(t_i,\hat{f}_n({\bf x_i})\right)\right]&amp;=&amp;
E\left[\left(t_i-E\left[t_i\mid{\bf x_i}\right]\right)^2\right]+
E\left[\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x})\right)^2\right] \\\
&amp;=&amp;E\left[u^2\right]+E\left[\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)^2\right]
\end{eqnarray}</div>
<p>ã“ã®ç¬¬ä¸€é …ã¯, çœŸã®å€¤ã¨æœ€å°åŒ–ã•ã‚ŒãŸç†æƒ³ã®é–¢æ•°ã®å·®ã§ã‚ã‚‹ã®ã§, ãƒã‚¤ã‚ºé …ã«å¯¾å¿œã™ã‚‹ã“ã¨ã¨ãªã‚‹.
å¾“ã£ã¦,&nbsp;ç¬¬ä¸€é …ã«é–¢ã—ã¦ã‚‚ã†å°‘ã—æ½œã‚Šè¾¼ã‚“ã§ã¿ã‚‹ã¨</p>
<div class="math">\begin{eqnarray}
E\left[\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)^2\right]&amp;=&amp;
E\left[\left(E\left[t_i\mid{\bf x_i}\right]-E\left[\hat{f}_n({\bf x_i})\right]+E\left[\hat{f}_n({\bf x_i})\right]-\hat{f}_n({\bf x_i})\right)^2\right]\ \left(\because {\rm augmentation\ trick}\right)\\\
&amp;=&amp;E\left[\left\{
\underbrace{\left(E\left[t_i\mid{\bf x_i}\right]-E\left[\hat{f}_n({\bf x_i})\right]\right)}_{a}+
\underbrace{\left(E\left[\hat{f}_n({\bf x_i})\right]-\hat{f}_n({\bf x_i})\right)}_{b}\right
\}^2\right]\\\
&amp;=&amp;E\left[
\begin{array}{c}
\left(E\left[t_i\mid{\bf x_i}\right]-E\left[\hat{f}_n({\bf x_i})\right]\right)^2+\\\
\left(E\left[\hat{f}_n({\bf x_i})\right]-\hat{f}_n({\bf x_i})\right)^2+\\\
2\left(E\left[t_i\mid{\bf x_i}\right]-E\left[\hat{f}_n({\bf x_i})\right]\right)\left(E\left[\hat{f}_n({\bf x_i})\right]-\hat{f}_n({\bf x_i})\right)^2
\end{array}
\right]\ \left(\because \eqref{eq:thirteenth}\right) \\\
&amp;=&amp;\begin{array}{c}
E\left[\left(E\left[t_i\mid{\bf x_i}\right]-E\left[\hat{f}_n({\bf x_i})\right]\right)^2\right]+\\\
E\left[\left(E\left[\hat{f}_n({\bf x_i})\right]-\hat{f}_n({\bf x_i})\right)^2\right]+\\\
2E\left[\left(E\left[t_i\mid{\bf x_i}\right]-E\left[\hat{f}_n({\bf x_i})\right]\right)\left(E\left[\hat{f}_n({\bf x_i})\right]-\hat{f}_n({\bf x_i})\right)^2\right]
\end{array}\ \\\
&amp;&amp;\left(\because \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#fn-2}{\text æœŸå¾…å€¤ã®ç·šå½¢æ€§}, \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#mjx-eqn-eq%3Aexaxiom3}{E\left[a A\right]=a E\left[A\right]}\right)
\end{eqnarray}</div>
<p>ç¬¬ä¸‰é …ã«ã¤ã„ã¦</p>
<div class="math">\begin{eqnarray}
&amp;2E\left[\left(E\left[t_i\mid{\bf x_i}\right]-E\left[\hat{f}_n({\bf x_i})\right]\right)\left(E\left[\hat{f}_n({\bf x_i})\right]-\hat{f}_n({\bf x_i})\right)^2\right]=
2\left(
\begin{array}{l}
E\left[E\left[t_i\mid{\bf x_i}\right]E\left[\hat{f}_n({\bf x_i})\right]\right]- \\\
E\left[E\left[\hat{f}_n({\bf x_i})\right]^2\right]- \\\
E\left[\hat{f}_n({\bf x_i})E\left[t_i\mid{\bf x_i}\right]\right]+ \\\
E\left[\hat{f}_n({\bf x_i})E\left[\hat{f}_n({\bf x_i})\right]\right]
\end{array}
\right)
\label{eq:fourteenth}\tag{13}
\end{eqnarray}</div>
<p>ã“ã“ã§</p>
<ul>
<li><span class="math">\(\href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#mjx-eqn-eq%3Aexaxiom3}{E\left[a A\right]=a E\left[A\right]}
, \href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#consExpisCons}{E\left[a\right]=a} \to E\left[E\left[a\right]\right]=a\)</span> ã‚ˆã‚Š 
<div class="math">$$E\left[E\left[t_i\mid{\bf x_i}\right]E\left[\hat{f}_n({\bf x_i})\right]\right]=E\left[t_i\mid{\bf x_i}\right]E\left[\hat{f}_n({\bf x_i})\right]$$</div>
</li>
<li><span class="math">\(\href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#consExpisCons}{E\left[a\right]=a} \to E\left[E\left[a\right]\right]=a\)</span> ã‚ˆã‚Š <div class="math">$$E\left[E\left[\hat{f}_n({\bf x_i})\right]^2\right]=E\left[\hat{f}_n({\bf x_i})\right]^2$$</div>
</li>
<li><span class="math">\(\href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#mjx-eqn-eq%3Aexaxiom3}{E\left[a A\right]=a E\left[A\right]}\)</span> ã‚ˆã‚Š <div class="math">$$E\left[\hat{f}_n({\bf x_i})E\left[t_i\mid{\bf x_i}\right]\right]=E\left[t_i\mid{\bf x_i}\right]E\left[\hat{f}_n({\bf x_i})\right]$$</div>
</li>
<li><span class="math">\(\href{https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#mjx-eqn-eq%3Aexaxiom3}{E\left[a A\right]=a E\left[A\right]}\)</span> ã‚ˆã‚Š <div class="math">$$E\left[\hat{f}_n({\bf x_i})E\left[\hat{f}_n({\bf x_i})\right]\right]=E\left[\hat{f}_n({\bf x_i})\right]^2$$</div>
</li>
</ul>
<p>ã‚ˆã£ã¦</p>
<div class="math">$$
\eqref{eq:fourteenth}=
2\left(
E\left[t_i\mid{\bf x_i}\right]E\left[\hat{f}_n({\bf x_i})\right]-
E\left[\hat{f}_n({\bf x_i})\right]^2-
E\left[t_i\mid{\bf x_i}\right]E\left[\hat{f}_n({\bf x_i})\right]+
E\left[\hat{f}_n({\bf x_i})\right]^2
\right)
=0
$$</div>
<p>\(\therefore\)</p>
<div class="math">\begin{eqnarray}
E\left[\left(E\left[t_i\mid{\bf x_i}\right]-\hat{f}_n({\bf x_i})\right)^2\right]
&amp;=&amp;
E\left[\left(E\left[t_i\mid{\bf x_i}\right]-E\left[\hat{f}_n({\bf x_i})\right]\right)^2\right]+E\left[\left(E\left[\hat{f}_n({\bf x_i})\right]-\hat{f}_n({\bf x_i})\right)^2\right] \\\
&amp;=&amp;
{\rm Bias}\left[\hat{f}_n({\bf x_i})\right]^2+{\rm Var}\left[\hat{f}_n({\bf x_i})\right]
\end{eqnarray}</div>
<p>ã¾ãŸ</p>
<div class="math">\begin{eqnarray}
E\left[L\left(t_i,\hat{f}_n({\bf x_i})\right)\right]={\rm Bias}\left[\hat{f}_n({\bf x_i})\right]^2+{\rm Var}\left[\hat{f}_n({\bf x_i})\right]+\sigma^2
\end{eqnarray}</div>
<p>ã“ã®ä¸€é€£ã®å±•é–‹ä½œæ¥­ã¯, ãƒã‚¤ã‚¢ã‚¹-ãƒãƒªã‚¢ãƒ³ã‚¹åˆ†è§£ã¨ã„ã‚ã‚Œã‚‹.
ãƒã‚¤ã‚¢ã‚¹ã¯, æå¤±ã®æœŸå¾…å€¤ã‚’æœ€å°åŒ–ã™ã‚‹ <span class="math">\(E\left[t|{\bf x_i}\right]\)</span> ã¨ã®ãšã‚Œã®æœŸå¾…å€¤ã§ã‚ã‚‹. 
å¾“ã£ã¦, é–¢æ•°ãƒ¢ãƒ‡ãƒ«ã‚’è¤‡é›‘ã«ã™ã‚‹ã»ã©å€¤ã¯æ¸›å°‘ã™ã‚‹.
ãƒãƒªã‚¢ãƒ³ã‚¹ã¯ãƒ¢ãƒ‡ãƒ«ã®åˆ†æ•£ã§ã‚ã‚Š, ãƒ¢ãƒ‡ãƒ«ã®è¤‡é›‘ã•ã‚’è¡¨ã™æŒ‡æ¨™ã§ã‚ã‚‹.
å¾“ã£ã¦, é–¢æ•°ãƒ¢ãƒ‡ãƒ«ã‚’è¤‡é›‘ã«ã™ã‚‹ã»ã©å€¤ã¯å¢—åŠ ã™ã‚‹.
ä¸¡è€…ã®ã“ã®é–¢ä¿‚æ€§ã‚’ãƒã‚¤ã‚¢ã‚¹ã¨ãƒãƒªã‚¢ãƒ³ã‚¹ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã¨ã„ã†.
å¤šãã®å ´åˆ, ã“ã‚Œã‚‰ãŒåŒæ™‚ã«å¯èƒ½ãªé™ã‚Šä½ã„å€¤ã‚’ã¨ã‚‹ãƒ¢ãƒ‡ãƒ«ã®ã“ã¨ã‚’,&nbsp;ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã™ã‚‹é©åˆ‡ãªãƒ¢ãƒ‡ãƒ«ã¨è¨€ã†ã“ã¨ãŒã§ãã‚‹ã ã‚ã†.</p>
<p>ã“ã“ã§, å…ˆã«ç¤ºã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã—ã¦, 4 æ¬¡å…ƒã¨ 9 æ¬¡å…ƒã®ç·šå½¢é–¢æ•°ã«ã‚ˆã‚‹è¿‘ä¼¼ã‚’è¡Œã„,&nbsp;ãã‚Œãã‚Œã®ãƒã‚¤ã‚¢ã‚¹ã¨ãƒãƒªã‚¢ãƒ³ã‚¹ã‚’æ¯”è¼ƒã™ã‚‹.</p>
<div class="highlight"><pre><span></span><span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">bias</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Real</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Fractional</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="n">a</span><span class="p">;</span> <span class="n">bias</span> <span class="n">fh</span> <span class="n">f</span> <span class="n">il</span> <span class="ow">=</span> <span class="p">(</span><span class="o">/</span><span class="p">(</span><span class="n">fromIntegral</span> <span class="o">$</span> <span class="n">length</span> <span class="n">il</span><span class="p">))</span> <span class="o">$</span> <span class="n">sum</span> <span class="o">$</span> <span class="n">map</span> <span class="p">((</span><span class="o">^^</span><span class="mi">2</span><span class="p">)</span> <span class="o">.</span> <span class="n">uncurry</span> <span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">.</span> <span class="n">first</span> <span class="n">f</span> <span class="o">.</span> <span class="n">second</span> <span class="n">fh</span> <span class="o">.</span> <span class="n">dupe</span><span class="p">)</span> <span class="n">il</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">var</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Real</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Fractional</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="n">a</span><span class="p">;</span> <span class="n">var</span> <span class="n">fh</span> <span class="n">il</span> <span class="ow">=</span> <span class="kr">let</span> <span class="n">len</span> <span class="ow">=</span> <span class="n">fromIntegral</span>  <span class="o">$</span> <span class="n">length</span> <span class="n">il</span><span class="p">;</span> <span class="n">s</span> <span class="ow">=</span> <span class="p">(</span><span class="o">/</span><span class="n">len</span><span class="p">)</span> <span class="o">$</span> <span class="n">sum</span> <span class="o">$</span> <span class="n">map</span> <span class="n">fh</span> <span class="n">il</span> <span class="kr">in</span> <span class="p">(</span><span class="o">/</span><span class="n">len</span><span class="p">)</span> <span class="o">$</span> <span class="n">sum</span> <span class="o">$</span> <span class="n">map</span> <span class="p">((</span><span class="o">^^</span><span class="mi">2</span><span class="p">)</span> <span class="o">.</span> <span class="n">fh</span><span class="p">)</span> <span class="n">il</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">f</span> <span class="ow">=</span> <span class="n">sin</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">fhat</span> <span class="ow">=</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="n">implicitFn</span> <span class="o">.</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="n">flip</span> <span class="n">resolve</span> <span class="n">dd</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">bias</span> <span class="p">(</span><span class="n">fhat</span> <span class="mi">4</span><span class="p">)</span> <span class="n">f</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">bias</span> <span class="p">(</span><span class="n">fhat</span> <span class="mi">9</span><span class="p">)</span> <span class="n">f</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span>
<span class="kt">True</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">var</span> <span class="p">(</span><span class="n">fhat</span> <span class="mi">4</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">var</span> <span class="p">(</span><span class="n">fhat</span> <span class="mi">9</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span>
<span class="kt">True</span>
</pre></div>


<p>å…ˆã«ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã—ã¾ã£ãŸ, 
10 æ¬¡å…ƒã®ãƒ¢ãƒ‡ãƒ«ã¨ 9&nbsp;æ¬¡å…ƒã®ãƒ¢ãƒ‡ãƒ«ã®ãƒã‚¤ã‚¢ã‚¹ã¨ãƒãƒªã‚¢ãƒ³ã‚¹ã‚’æ¯”è¼ƒã™ã‚‹.</p>
<div class="highlight"><pre><span></span><span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">bias</span> <span class="p">(</span><span class="n">fhat</span> <span class="mi">9</span><span class="p">)</span> <span class="n">f</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">bias</span> <span class="p">(</span><span class="n">fhat</span> <span class="mi">10</span><span class="p">)</span> <span class="n">f</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span>
<span class="kt">True</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">var</span> <span class="p">(</span><span class="n">fhat</span> <span class="mi">9</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">var</span> <span class="p">(</span><span class="n">fhat</span> <span class="mi">10</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">]</span>
<span class="kt">True</span>
</pre></div>


<p>\(L^2\)&nbsp;æ­£å‰‡åŒ–(\(\lambda=0.1,1,10\))ã‚’æ–½ã—ãŸå ´åˆã‚’è¦‹ã¦ã¿ã‚‹.</p>
<div class="highlight"><pre><span></span><span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">import</span> <span class="k">qualified</span> <span class="nn">ML.Approx.Regularization.L2</span> <span class="k">as</span> <span class="n">Reg</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">fhat&#39;</span> <span class="ow">=</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="n">implicitFn</span> <span class="o">.</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="n">flip</span> <span class="kt">Reg</span><span class="o">.</span><span class="n">resolve</span> <span class="n">dd</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">mapM_</span> <span class="p">(</span><span class="n">print</span> <span class="o">.</span> <span class="p">(</span><span class="n">flip</span> <span class="p">(</span><span class="n">flip</span> <span class="n">bias</span> <span class="n">f</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">])</span> <span class="o">.</span> <span class="n">fhat&#39;</span><span class="p">)</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="mf">1.9110967187955293e-2</span>
<span class="mf">2.283386765131595e-2</span>
<span class="mf">4.427871557982087e-2</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">mapM_</span> <span class="p">(</span><span class="n">print</span> <span class="o">.</span> <span class="p">(</span><span class="n">flip</span> <span class="n">var</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">])</span> <span class="o">.</span> <span class="n">fhat&#39;</span><span class="p">)</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="mf">0.5855240280868919</span>
<span class="mf">0.5530852362842676</span>
<span class="mf">0.4586444106136849</span>
</pre></div>


<h3>èª¤å·®åˆ†å¸ƒãŒæ­£è¦åˆ†å¸ƒã§ãªã„å ´åˆã®ç·šå½¢å›å¸°</h3>
<p>å¼ \(\eqref{eq:ssecond}\) ç­‰ã§, ç·šå½¢æœ€å°äºŒä¹—æ³•ãŒã™ã¹ã¦ã®ãƒã‚¤ã‚ºé …ã®ç¢ºç‡åˆ†å¸ƒã‚’åŒä¸€è¦–ã™ã‚‹ã“ã¨ã‚’ç¤ºã—ãŸ. 
ã“ã®ä»®å®šã«ã‚ˆã‚Š, èª¤å·®ã®åˆ†å¸ƒãŒéå¯¾ç§°, ã‚ã‚‹ã„ã¯å¤–ã‚Œå€¤ãŒé¡•è‘—ã«è¦‹ã‚‰ã‚Œã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã™ã‚‹ç·šå½¢æœ€å°äºŒä¹—æ³•ã®é©ç”¨çµæœã¯, ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¨å®š,&nbsp;ä¿¡é ¼åŒºé–“ãŠã‚ˆã³ãã®çµ±è¨ˆé‡ã«ã¤ã„ã¦ä¿¡é ¼ã§ããªããªã‚‹.</p>
<div class="highlight"><pre><span></span><span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">d</span> <span class="n">n</span> <span class="n">n&#39;</span> <span class="n">p</span> <span class="ow">=</span> <span class="n">zipWith</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">y</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">))</span> <span class="p">[</span><span class="n">n</span><span class="o">..</span><span class="n">fromIntegral</span> <span class="n">n&#39;</span><span class="p">]</span> <span class="o">&lt;$&gt;</span> <span class="kr">let</span> <span class="n">uni</span> <span class="ow">=</span> <span class="n">normalIO&#39;</span> <span class="n">p</span> <span class="kr">in</span> <span class="n">replicateM</span> <span class="p">(</span><span class="n">succ</span> <span class="n">n&#39;</span><span class="p">)</span> <span class="n">uni</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">dleft</span> <span class="ow">&lt;-</span> <span class="n">d</span> <span class="mi">0</span> <span class="mi">10</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">dright</span> <span class="ow">&lt;-</span> <span class="n">d</span> <span class="mi">15</span> <span class="mi">25</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">dd</span> <span class="ow">=</span> <span class="n">dleft</span> <span class="o">++</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">&lt;-</span> <span class="n">take</span> <span class="mi">4</span> <span class="p">[</span><span class="n">succ</span> <span class="o">$</span> <span class="n">fst</span> <span class="o">$</span> <span class="n">last</span> <span class="n">dleft</span> <span class="o">..</span><span class="p">]]</span> <span class="o">++</span> <span class="n">dright</span>
<span class="nf">Î»</span><span class="o">&gt;</span> <span class="n">plot</span> <span class="o">$</span> <span class="kt">PP</span> <span class="s">&quot;./image.png&quot;</span> <span class="s">&quot;Figure&quot;</span> <span class="s">&quot;points&quot;</span> <span class="s">&quot;line&quot;</span> <span class="n">dd</span> <span class="o">$</span> <span class="n">fromJust</span> <span class="o">$</span> <span class="n">implicitFn</span> <span class="o">$</span> <span class="n">fromJust</span> <span class="o">$</span> <span class="n">resolve</span> <span class="mi">1</span> <span class="n">dd</span>
</pre></div>


<p>\(\mathrm{N}(0,0.2)\) ã®ç¢ºç‡èª¤å·®ã®ä»–ã«, 4 ã¤ã®å¤–ã‚Œå€¤<sup id="fnref-10"><a class="footnote-ref" href="#fn-10">10</a></sup>ã‚’ä»•è¾¼ã‚“ã ã“ã®ãƒ‡ãƒ¼ã‚¿ã¸ç·šå½¢æœ€å°äºŒä¹—æ³•(\(n=1\))ã‚’æ–½ã™ã¨,&nbsp;å¤–ã‚Œå€¤ã«å½±éŸ¿ã•ã‚ŒãŸæ¨å®šãŒè¡Œã‚ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚‹.</p>
<p style="text-align:center">
<img src="../../../../../images/2018/November/outliers.png" alt="lenear equations" width="600px">
</p>

<p>ã“ã‚Œã‚’é˜²ãæ–¹æ³•ã¯ã„ãã¤ã‹å­˜åœ¨ã™ã‚‹.
ä»¥ä¸‹, èª¬æ˜ã®ãŸã‚ã«æ”¹ã‚ã¦, \(p\) å€‹ã®ç‹¬ç«‹å¤‰æ•°ã‚’æœ‰ã™ã‚‹å¤šé‡ç·šå½¢å›å¸°ãƒ¢ãƒ‡ãƒ«ã‚’ \[\boldsymbol{y}=X&#8217;\boldsymbol{\beta}+\boldsymbol{u}\] ã¨ã™ã‚‹.
ã“ã“ã§ \(\boldsymbol{\beta}=\boldsymbol{a}\) ã§ \(X&#8217;\) ã¯èª¬æ˜å¤‰æ•°ã®è¡Œ \(\boldsymbol{x&#8217;_i}=\left(x&#8217;_{i1}, x&#8217;_{i2},\cdots,x&#8217;_{ip}\right)^T\) 
ã‚’æœ‰ã™ã‚‹ãƒ•ãƒ«ãƒ©ãƒ³ã‚¯è¡Œåˆ— \(X&#8217;\in\mathbb{R}^{m\times p}\) ã§ã‚ã‚Š, 
\(\boldsymbol{u}\) ã¯ <a href="https://falgon.github.io/roki.log/posts/2018/10æœˆ/28/probabilityTerms/#iid">i.i.d</a> ã‹ã¤
\(\mathrm{N}(0,\sigma^2)\) ã«å¾“ã†ç¢ºç‡èª¤å·®ã®ãƒ™ã‚¯ãƒˆãƒ« \(\boldsymbol{u}=\left(u_1,u_2,\cdots,u_m\right)^T\in\mathbb{R}^{m\times 1}\) ã¨ã™ã‚‹.
ãªãŠã“ã®å®šç¾©ã«å¾“ã†ã¨, (Ordinary least squares&nbsp;ã‚ˆã‚Š)é€šå¸¸ã®æœ€å°äºŒä¹—æ³•ã¯æ¬¡ã®å¼ã§å®šç¾©ã§ãã‚‹.</p>
<div class="math">\begin{eqnarray}
\mathrm{OLS}(X',\boldsymbol{y})&amp;:=&amp;\mathrm{arg}\min_\boldsymbol{\boldsymbol{\beta}}\sum^m_{i=1}r(\boldsymbol{\beta})^2_i \label{eq:eleventh}\tag{14} \\\
&amp;=&amp;\eqref{eq:tenth}
\end{eqnarray}</div>
<p>ã“ã“ã§ \(r(\boldsymbol{\beta})_i\) ã¯ \(r(\boldsymbol{\beta})_i=y_i-\boldsymbol{x}_i\boldsymbol{\beta}\) ã§ã‚ã‚‹(\(\eqref{eq:fourth}\) ã®åå·®ã®éƒ¨åˆ†).
ä»¥ä¸‹, ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒ™ã‚¯ãƒˆãƒ« \(\boldsymbol{\beta}\) ã‚’æ˜ç¤ºçš„ã«ç¤ºã™å¿…è¦ãŒãªã„ã¨ãã«ã¯ \(r(\boldsymbol{\beta})_i\) ã‚’ \(r_i\)&nbsp;ã¨ç¤ºã™ã“ã¨ã¨ã™ã‚‹.</p>
<h4>æœ€å°åˆˆè¾¼ã¿äºŒä¹—æ³•</h4>
<p>ä¸€è¨€ã§ã„ãˆã°, ã“ã®æ–¹æ³•ã¯å˜ç´”ã«å¤–ã‚Œå€¤ã‚’æœ€å°äºŒä¹—æ³•ã®å¯¾è±¡ã‹ã‚‰é™¤å¤–ã—ã¦ã—ã¾ã†æ–¹æ³•ã§ã‚ã‚‹(ä»¥ä¸‹ Least trimmed squares<sup id="fnref-11"><a class="footnote-ref" href="#fn-11">11</a></sup> ã‚ˆã‚Š <span class="caps">LTS</span>&nbsp;ã¨è¨˜è¿°)ã¨ã„ã‚ã‚Œã‚‹.</p>
<div class="math">\begin{eqnarray}
\mathrm{LTS}(X,\boldsymbol{y},k)&amp;:=&amp;\mathrm{arg}\min_\boldsymbol{\beta}\sum^k_{i=1}r(\boldsymbol{\beta})^2_{(i)} \\\
&amp;&amp;{\rm s.t.\ } r(\boldsymbol{\beta})^2_{(1)}\leq r(\boldsymbol{\beta})^2_{(2)}\leq\cdots\leq r(\boldsymbol{\beta})^2_{(m)}
\end{eqnarray}</div>
<p>ã“ã“ã§ \(r(\boldsymbol{\beta})_{(i)}\) ã¯ \(i\) ç•ªç›®ã«å°ã•ã„æ®‹å·®ã‚’ç¤ºã™.
è¦ã™ã‚‹ã«, \(m\) å€‹ã®åå·®ã®äºŒä¹—ã‚’æ˜‡é †ã§ä¸¦ã¹, 
é©å½“ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ \(k\ \left(k\leq m\right)\) ã«å¯¾ã—ã¦ \(\sum^k_{i=1}\left(r^2\right)_{i:m}\) ã‚’æœ€å°åŒ–ã™ã‚‹å›å¸°ä¿‚æ•°ã‚’æ±‚ã‚ã‚‹ã“ã¨ã‚’ã„ã†.
å½“ç„¶, \(k=m\) ã¨ã™ã‚‹ã¨, é€šå¸¸ã®æœ€å°äºŒä¹—æ³•ã¨åŒã˜çµæœã¨ãªã‚‹ãŒ, \(k\lt m\) ã§è¨­å®šã™ã‚‹ã“ã¨ã§ \(m-k\) å€‹ã®å¤§ããªåå·®ã‚’ã‚‚ã¤ãƒ‡ãƒ¼ã‚¿ã‚’ç„¡è¦–ã§ãã‚‹. 
<span class="caps">LTS</span>&nbsp;ã¯æ¬¡ã®æ‰‹é †ã§å®Ÿè¡Œã™ã‚‹.</p>
<p><strong><span class="caps">TODO</span>: <span class="caps">LTS</span>&nbsp;ã®æ‰‹é †</strong></p>
<p><strong><span class="caps">TODO</span>: <span class="caps">LTS</span>&nbsp;ã«ã‚ˆã‚‹è¿‘ä¼¼ã®å®Ÿè£…</strong></p>
<p>ã¾ãŸ, å„ãƒ‡ãƒ¼ã‚¿ç‚¹ã«å¯¾ã—ã¦é‡ã¿(ç¢ºç‡åˆ†å¸ƒ)ã‚’ä»˜ä¸ã—,
ãã‚Œã‚‰ã‚’å˜ãªã‚‹ç®—è¡“å¹³å‡ã¨ã—ã¦æ‰ãˆã‚‹ã®ã§ã¯ãªã,
æœŸå¾…å€¤ã¨ã—ã¦æ‰ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹æ–¹æ³•ãŒæ€ã„ã¤ã. å®Ÿéš›ã«ã“ã‚Œã‚‰ã¯ãã‚Œãã‚Œåå‰ãŒã¤ã„ã¦ã„ã¦, å‰è€…ã¯æœ€å°åˆˆã‚Šè¾¼ã¿äºŒä¹—æ³•,&nbsp;å¾Œè€…ã¯ãƒ­ãƒã‚¹ãƒˆæ¨å®šã¨ã„ã‚ã‚Œã‚‹.</p>
<p><strong><span class="caps">TODO</span>: æœ€å°åˆˆã‚Šè¾¼ã¿ã«æƒ…å ±,&nbsp;ãƒ­ãƒã‚¹ãƒˆæ¨å®šã«ã‚ˆã‚‹è¿‘ä¼¼ã®å®Ÿè£…</strong></p>
<h3>å‚è€ƒæ–‡çŒ®</h3>
<ol>
<li>ã€Œ<a href="https://mathtrain.jp/seikiequ">æ­£è¦æ–¹ç¨‹å¼ã®å°å‡ºã¨è¨ˆç®—ä¾‹ - é«˜æ ¡æ•°å­¦ã®ç¾ã—ã„ç‰©èª</a>ã€ 2018 å¹´ 11 æœˆ 2&nbsp;æ—¥ã‚¢ã‚¯ã‚»ã‚¹.</li>
<li>ã€Œ<a name="ref1" href="http://tekenuko.hatenablog.com/entry/2017/11/18/214317">Rã§ã‚¹ãƒ‘ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ï¼šElastic Netå›å¸°ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã¿ã‚‹</a>ã€ 2018 å¹´ 11 æœˆ 5&nbsp;æ—¥ã‚¢ã‚¯ã‚»ã‚¹.</li>
<li>å·é‡ã€€ç§€ä¸€, å»£ç€¬ã€€æ…§, ç«‹çŸ³ã€€æ­£å¹³, å°è¥¿ã€€è²å‰‡ (2010)ã€Œ<a href="http://svr4.terrapub.co.jp/journals/jjssj/pdf/3902/39020211.pdf">å›å¸°ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã¨ \(L_1\) å‹æ­£å‰‡åŒ–æ³•ã®æœ€è¿‘ã®å±•é–‹</a>ã€, æ—¥æœ¬çµ±è¨ˆå­¦ä¼šèªŒ ç¬¬ 39 å·», ç¬¬ 2 å·, 211 é  ã€œ 242 é  pp.211~215, 2018 å¹´ 11 æœˆ 5&nbsp;æ—¥ã‚¢ã‚¯ã‚»ã‚¹.</li>
<li>ã€Œ<a href="https://nagahara-masaaki.github.io/assets/pdfs/lecture13.pdf">æ•°å€¤è¨ˆç®— å¤§é˜ªå¤§å­¦åŸºç¤å·¥å­¦éƒ¨</a>ã€ 2018 å¹´ 11 æœˆ 5&nbsp;æ—¥ã‚¢ã‚¯ã‚»ã‚¹.</li>
<li>ç¾æ·»ã€€æ³°äºº (2010)ã€Œ<a href="https://www.terrapub.co.jp/journals/jjssj/pdf/3902/39020161.pdf" name="ref3">çµŒæ¸ˆã¨çµ±è¨ˆã®é–“ã§</a>ã€, æ—¥æœ¬çµ±è¨ˆå­¦ä¼šèªŒ ç¬¬ 38 å·», ç¬¬ 2 å·, 161 é  ã€œ 179  é  pp.173~175 2018 å¹´ 11 æœˆ 10&nbsp;æ—¥ã‚¢ã‚¯ã‚»ã‚¹.</li>
<li>ã€Œ<a href="https://www.hellocybernetics.tech/entry/2017/01/24/100415">ãƒã‚¤ã‚¢ã‚¹-ãƒãƒªã‚¢ãƒ³ã‚¹åˆ†è§£ï¼šæ©Ÿæ¢°å­¦ç¿’ã®æ€§èƒ½è©•ä¾¡ - <span class="caps">HELLO</span> <span class="caps">CYBERNETICS</span></a>ã€ 2018 å¹´ 11 æœˆ 13&nbsp;æ—¥ã‚¢ã‚¯ã‚»ã‚¹.</li>
<li>Jurgen A. Doornik (2011) &#8220;<a name="ref2" class="disabled">Robust Estimation Using Least Trimmed Squares</a>&#8220;, Institute for Economic Modelling, Oxford Martin School, and Economics Department, University of Oxford, <span class="caps">UK</span></li>
<li>Rousseeuw and <span class="caps">B.C.</span> Van Zomeren (1990) &#8220;<a name="ref4" class="disabled">Unmasking multivariate outliers and leverage points</a>&#8220;, Journal of the American Statistical Association,&nbsp;pp.633â€“639</li>
<li>Vincenzo Verardi &#8220;<a name="ref5" href="https://www.stata.com/meeting/uk08/VerardiRobustStatisticsinStata.pdf">Robust Statistics Statistics in Stata</a>&#8220;, 2018 å¹´ 11 æœˆ 17&nbsp;æ—¥ã‚¢ã‚¯ã‚»ã‚¹.</li>
</ol>
<div class="footnote">
<hr>
<ol>
<li id="fn-1">
<p>ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯, <a href="http://math.arizona.edu/~dsl/bmile.htm">Data Set for <span class="caps">CHAPTER</span> 2 - <span class="caps">DIFFERENTIAL</span> <span class="caps">EQUATIONS</span> graphics, models, data</a> ã‚’åˆ©ç”¨ã•ã›ã¦ã„ãŸã ã„ãŸ.&#160;<a class="footnote-backref" href="#fnref-1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn-2">
<p>æœ€å°äºŒä¹—æ³•ã®å®šç¾©ã«ã‚ˆã‚Šã€Œ\(\mathrm{Cov}(x,y)\gt 0\leftrightarrow\)æœ€å°äºŒä¹—æ³•ã«ã‚ˆã‚‹ç›´ç·šã®å‚¾ããŒæ­£ã€ãŒã„ãˆã‚‹ã“ã¨ã§, ã€Œç›¸é–¢ä¿‚æ•°ãŒ \(0\) ã§ã‚ã‚‹ã¨ã, å„ \(x_i,y_i\) ã«ç›¸é–¢é–¢ä¿‚ãŒãªã„ã€ã‚’æ•°å­¦çš„ã«èª¬æ˜ã§ããŸã¨æ‰ãˆã‚‹ã“ã¨ãŒã§ãã‚‹.&#160;<a class="footnote-backref" href="#fnref-2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn-3">
<p>\(n&#8217;=m\) ã§, åŒè¡Œåˆ—ã®ã‚ˆã†ãªå„è¡ŒãŒåˆé … <span class="math">\(1\)</span> ã®ç­‰æ¯”æ•°åˆ—ã§ã‚ã‚‹ã‚ˆã†ãªæ­£æ–¹è¡Œåˆ—ã‚’ãƒ´ã‚¡ãƒ³ãƒ‡ãƒ«ãƒ¢ãƒ³ãƒ‰è¡Œåˆ—ã¨ã„ã†.&#160;<a class="footnote-backref" href="#fnref-3" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2-3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn-4">
<p>ã—ãŸãŒã£ã¦, å¼ã«èµ·ã“ã™ã¨ä»¥ä¸‹ã®é€šã‚Š: <div class="math">\begin{eqnarray}E\left[y_i\right]&amp;=&amp;E\left[\sum^m_{j=0}a_jf_j\left(x_i^0,x_i^1,\cdots,x_i^n\right)+\epsilon_i\right]\\\ &amp;=&amp;\sum^m_{j=0}a_jf_j\left(x_i^0,x_i^1,\cdots,x_i^n\right)+E\left[\epsilon_i\right] \\\ &amp;=&amp;\sum^m_{j=0}a_jf_j\left(x_i^0,x_i^1,\cdots,x_i^n\right) \end{eqnarray}</div> ã¾ãŸ, \[V\left[y_i\right]=V\left[\sum^m_{j=0}a_jf_j\left(x_i^0,x_i^1,\cdots,x_i^n\right)+\epsilon_i\right]=V\left[\epsilon_i\right]=\sigma^2\]&#160;<a class="footnote-backref" href="#fnref-4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn-5">
<p>è¤‡ç´ è¡Œåˆ—ã«ã¤ã„ã¦æ‰±ã†å ´åˆ, è»¢ç½®è¡Œåˆ—ã‚’éšä¼´è¡Œåˆ—, ç›´äº¤è¡Œåˆ—ã‚’ãƒ¦ãƒ‹ã‚¿ãƒªè¡Œåˆ—ã«ã™ã‚Œã°åŒæ§˜ã«ã—ã¦æ±‚ã¾ã‚‹.&#160;<a class="footnote-backref" href="#fnref-5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn-6">
<p>ä¾‹ãˆã°, Wolfram è¨€èªã§ã¯<a href="https://reference.wolfram.com/language/ref/PseudoInverse.html"><code>PseudoInverse</code></a>ã¨ã„ã†çµ„ã¿è¾¼ã¿ã‚·ãƒ³ãƒœãƒ«ãŒã‚ã‚‹ãŒ, ã“ã‚Œã¯ <span class="caps">MP</span> é€†è¡Œåˆ—ã‚’ç®—å‡ºã™ã‚‹. ã¾ãŸ R è¨€èªã®<a href="https://www.rdocumentation.org/packages/pracma/versions/1.9.9/topics/pinv"><code>pinv</code></a>é–¢æ•°ã‚‚åŒæ§˜.&#160;<a class="footnote-backref" href="#fnref-6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn-7">
<p>ä¸€æ„æ€§ã®è¨¼æ˜: ã„ã¾ \(X\) ã« 2 ã¤ã®ç›¸ç•°ãªã‚‹ <span class="caps">MP</span> é€†è¡Œåˆ— \(A^{\dagger}\not =B^{\dagger}\) ãŒå­˜åœ¨ã™ã‚‹ã¨ä»®å®šã™ã‚‹. ã¾ãš \(A^{\dagger}\) ã«ã¤ã„ã¦, \(A^{\dagger} = A^{\dagger} X A^\dagger = A^\dagger(X A^\dagger)^T=A^\dagger(X B^\dagger X A^\dagger)^T=A^\dagger(X A^\dagger)^T(X B^\dagger)^T= A^\dagger X A^\dagger X B^\dagger=A^\dagger X B^\dagger\). æ¬¡ã« \(B^\dagger\) ã«ã¤ã„ã¦, \(B^\dagger = B^\dagger X B^\dagger = (B^\dagger X)^T B^\dagger = (B^\dagger X A^\dagger X)^T B^\dagger = (A^\dagger X)^T (B^\dagger X)^T B^\dagger = A^\dagger X B^\dagger X B^\dagger = A^\dagger X B^\dagger\). èƒŒç†ã«ã‚ˆã‚Š, \(A^\dagger=B^\dagger\). \(\square\)&#160;<a class="footnote-backref" href="#fnref-7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn-8">
<p>æœ€å°äºŒä¹—å½¢ä¸€èˆ¬é€†è¡Œåˆ—ãŒ <span class="caps">MP</span> é€†è¡Œåˆ—ã§ã‚ã‚‹ã“ã¨ã®è¨¼æ˜: \(X^{\dagger}X=\underbrace{\left(X^T X\right)^{-1}X^T}_{X^\dagger} X=I\) ã ã‹ã‚‰ \(\eqref{eq:sixth},\eqref{eq:seventh}, \eqref{eq:eigth}, \eqref{eq:ninth}\) ã‚ˆã‚Š <div class="math">\begin{eqnarray}X X^\dagger X&amp;=&amp;X\left(X^\dagger X\right)&amp;=&amp;X\\\ X^\dagger X X^\dagger&amp;=&amp;\left(X^\dagger X\right)X^\dagger&amp;=&amp;X^\dagger\\\ \left(X^\dagger X\right)^T&amp;=&amp;I^T&amp;=&amp;I&amp;=&amp;X^\dagger X\\\ \left(X X^\dagger\right)^T&amp;=&amp;\left\{X\left(X^T X\right)^{-1}X^T\right\}^T&amp;=&amp;X\left(X^T X\right)^{-1}X^T&amp;=&amp;X X^\dagger\end{eqnarray}</div> ãªãŠæœ€å¾Œã®å¼å¤‰å½¢ã§ã¯, \(\left(A B\right)^T =B^T A^T, \left(A^{-1}\right)^T=\left(A^T\right)^{-1}\) ã‚’ç”¨ã„ãŸ. \(\square\)&#160;<a class="footnote-backref" href="#fnref-8" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn-9">
<p>ã“ã®ã‚ˆã†ãª, \(\lambda\sum_{j=0}^{n}\left|a_j\right|^q\) ã§ \(q=2\) ã®å ´åˆã‚’ Ridge å›å¸°ã¨ã„ã†. ã¾ãŸ \(q=1\) ã®ã¨ã(ã™ãªã‚ã¡æ­£å‰‡åŒ–é …ãŒ \(L^1\) ãƒãƒ«ãƒ )ã‚’ Lasso å›å¸°ã¨ã„ã†. ã•ã‚‰ã«, ã“ã‚Œã‚‰ã®æ­£å‰‡åŒ–é …ã®ç·šå½¢çµåˆã®å½¢å¼ã‚’ã¨ã‚‹ Elastic Net å›å¸°ã¨ã„ã†ãƒ¢ãƒ‡ãƒ«ã‚‚ã‚ã‚‹(Elastic Net å›å¸°ã«é–¢ã™ã‚‹<a href="#ref1">å‚è€ƒæ–‡çŒ®2</a>). ã“ã®å½¢å¼ã§è¡¨ã›ã‚‹æ­£å‰‡åŒ–é …ã‚’ç”¨ã„ã‚‹å›å¸°ã‚’ãƒ–ãƒªãƒƒã‚¸å›å¸°ã¨ã„ã†.&#160;<a class="footnote-backref" href="#fnref-9" title="Jump back to footnote 9 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2-9" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
<li id="fn-10">
<p>ã“ã®ã‚ˆã†ãª, ç·šå½¢æ€§ã®è¦‹ã‚‰ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¾“ã‚ãš, ã‹ã¤ç›´äº¤åº§æ¨™ç³»ã«ãŠã‘ã‚‹ \(Y\) è»¸æ–¹å‘ã«ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆ \(\left(x&#8217;_{ij},y_i\right)\) ãŒå¤–ã‚Œã¦ã„ã‚‹ã‚ˆã†ãªç‚¹ã‚’å‚ç›´å¤–ã‚Œå€¤(è‹±: vertical outlier)ã¨ã„ã†. ã¾ãŸåŒçŠ¶æ³ä¸‹ã§ \(X\) è»¸æ–¹å‘ã«å¤§ããå¤–ã‚Œã¦ã„ã‚‹ã‚ˆã†ãªç‚¹ã‚’æ‚ªã„ãƒ¬ãƒãƒ¬ãƒƒã‚¸ç‚¹(è‹±: bad leverage point)ã¨ã„ã†. ã•ã‚‰ã«, \(\left(x&#8217;_{ij},y_i\right)\) ãŒå¤§å¤šæ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã†ã¨ã, ãã‚Œã‚’è‰¯ã„ãƒ¬ãƒãƒ¬ãƒƒã‚¸ç‚¹(è‹±: good leverage point)ã¨ã„ã†(\(\to\)<a href="#ref4">å‚è€ƒæ–‡çŒ®8</a>, <a href="#ref5">å‚è€ƒæ–‡çŒ®9</a>).&#160;<a class="footnote-backref" href="#fnref-10" title="Jump back to footnote 10 in the text">&#8617;</a></p>
</li>
<li id="fn-11">
<p><span class="caps">LTS</span> ã®æ­´å²çš„èƒŒæ™¯ãŠã‚ˆã³å°‚é–€å®¶ã‚‰ã«ã‚ˆã‚‹èªè­˜ã«é–¢ã™ã‚‹è¨€åŠ: <i>Peter Rousseeuw introduced several robust regression estimators, including least median of squares (<span class="caps">LMS</span>) and least trimmed squares (<span class="caps">LTS</span>), see Rousseeuw (1984) as well as the monograph Rousseeuw and Leroy (1987). <span class="caps">LTS</span> converges at rate <span class="math">\(n^{\frac{1}{2}}\)</span> with the same assymptotic efficiency under normalityas Huberâ€™s skip estimator. The <span class="caps">LMS</span> convergence rate is <span class="math">\(n^{\frac{1}{3}}\)</span> and its objective function is less smooth than <span class="caps">LTS</span>. As a consequence, as argued in Rousseeuw and van Driessen (2006), <span class="caps">LTS</span> is now preferred over <span class="caps">LMS</span>.</i> &#8212; <a href="#ref2">å‚è€ƒæ–‡çŒ®7 pp.2</a>, <i>ã“ã®ä»–ã«ã‚‚æ®‹å·®ã® 2 ä¹—ã®ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ³ã‚’æœ€å°‘ã«ã™ã‚‹ <span class="caps">LMS</span> (least median of squares) ãªã©ãŒææ¡ˆã•ã‚Œã¦ã„ã‚‹ãŒï¼Œã„ãšã‚Œã‚‚åæŸãŒé…ãï¼ŒåŠ¹ç‡ã‚‚é«˜ããªã„ã“ã¨ã‚‚ã‚ã‚Šï¼ŒHuber (2009) ã¯æ ¹æœ¬çš„ãªå•é¡Œã®æ¤œè¨ãŒå¿…è¦ã¨æŒ‡æ‘˜ã—ã¦ã„ã‚‹ï¼</i> &#8212; <a href="#ref3">å‚è€ƒæ–‡çŒ®5 pp.174</a>&#160;<a class="footnote-backref" href="#fnref-11" title="Jump back to footnote 11 in the text">&#8617;</a></p>
</li>
</ol>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (true) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js','color.js','enclose.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: false," +
        "    messageStyle: 'None'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
      </div>
<!-- /.entry-content -->
      <footer class="post-info text-muted">
        <button type="button" class="btn btn-default">          
          <a href="../../../../../category/math.html"><div class="fa fa-lg fa-folder-open"></div> math</a>
        </button>
        <button type="button" class="btn btn-default">
          <a href="../../../../../tag/math.html"><div class="fa fa-lg fa-tag"></div> math</a>
        </button>
        <button type="button" class="btn btn-default">
          <a href="../../../../../tag/haskell.html"><div class="fa fa-lg fa-tag"></div> haskell</a>
        </button>
      </footer>
      <!-- /.post-info -->
    <!-- Comment BEGIN -->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'roki-log';
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <!-- Comment END -->
    </section>
    </div>
<footer class="footer">
      <div class="container">
          <p class="footer-text">&copy; <a href="../../../../..">roki.log</a> powered by 
          <a href="https://getpelican.com/">pelican</a> and 
          <a href="https://github.com/falgon/nikhil-theme">nikhil-theme (forked)</a><br>
              <small>  <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.ja"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.ja">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>, except where indicated otherwise.
</small>
            </p>
   </div>
</footer>    <script src="../../../../../theme/js/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-116653080-1', 'auto');
      ga('send', 'pageview');
       $('#myModal').modal({show: true});

    </script>
  </body>
</html>